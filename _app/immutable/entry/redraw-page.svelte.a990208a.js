import{S as D,i as A,s as S,k as d,a as V,l as p,m as g,c as B,h,_ as O,n as f,b as y,G as m,H as b,o as j,w as R,d as v,f as N,g as k,v as T,q as G,r as L,$ as C,K as I,L as M,R as z,y as H,z as J,A as K,B as U}from"../chunks/index.cab44b83.js";import{p as W,a as w}from"../chunks/utils.1a88de2c.js";function X(i){let e,s,r,n,a;return{c(){e=d("div"),s=d("img"),n=V(),a=d("canvas"),this.h()},l(t){e=p(t,"DIV",{class:!0});var l=g(e);s=p(l,"IMG",{src:!0,alt:!0,class:!0}),n=B(l),a=p(l,"CANVAS",{class:!0}),g(a).forEach(h),l.forEach(h),this.h()},h(){O(s.src,r="")||f(s,"src",r),f(s,"alt",""),f(s,"class","hidden"),f(a,"class","absolute top-0 left-0 h-full"),f(e,"class","relative")},m(t,l){y(t,e,l),m(e,s),i[4](s),m(e,n),m(e,a),i[5](a)},p:b,i:b,o:b,d(t){t&&h(e),i[4](null),i[5](null)}}}function F(i,e,s){let{persona:r}=e,{strokes:n}=e;const a=W[r];let t,l;function o(){console.log("RENDER");const c=l.getContext("2d");if(c==null){w(`Error: Could not get canvas context of ${r}.`);return}c.drawImage(t,0,0,l.width,l.height);for(let E of n){console.log(E);const q=new Path2D(E.svg);c.strokeStyle="black",c.stroke(q),c.rect(10,10,150,100),c.stroke()}}j(()=>{if(a==null){w(`Error: Image path of persona ${r} not found.`);return}s(0,t.onload=o,t),s(0,t.src=a,t)});function u(c){R[c?"unshift":"push"](()=>{t=c,s(0,t)})}function _(c){R[c?"unshift":"push"](()=>{l=c,s(1,l)})}return i.$$set=c=>{"persona"in c&&s(2,r=c.persona),"strokes"in c&&s(3,n=c.strokes)},[t,l,r,n,u,_]}class Q extends D{constructor(e){super(),A(this,e,F,X,S,{persona:2,strokes:3})}}function P(i,e,s){const r=i.slice();return r[8]=e[s],r}function Y(i){let e,s,r,n,a,t,l;return{c(){e=d("div"),s=d("textarea"),r=V(),n=d("button"),a=G("Redraw"),this.h()},l(o){e=p(o,"DIV",{class:!0});var u=g(e);s=p(u,"TEXTAREA",{name:!0,class:!0}),g(s).forEach(h),r=B(u),n=p(u,"BUTTON",{class:!0});var _=g(n);a=L(_,"Redraw"),_.forEach(h),u.forEach(h),this.h()},h(){f(s,"name","points"),f(s,"class","w-10/12 h-64 border"),f(n,"class","mt-8 py-2 px-4 bg-blue-600 border rounded shadow-sm text-white"),f(e,"class","flex flex-col items-center justify-center mt-16")},m(o,u){y(o,e,u),m(e,s),C(s,i[2]),m(e,r),m(e,n),m(n,a),t||(l=[I(s,"input",i[5]),I(n,"click",i[4])],t=!0)},p(o,u){u&4&&C(s,o[2])},i:b,o:b,d(o){o&&h(e),t=!1,M(l)}}}function Z(i){let e,s,r=i[3],n=[];for(let t=0;t<r.length;t+=1)n[t]=x(P(i,r,t));const a=t=>v(n[t],1,1,()=>{n[t]=null});return{c(){e=d("div");for(let t=0;t<n.length;t+=1)n[t].c();this.h()},l(t){e=p(t,"DIV",{class:!0});var l=g(e);for(let o=0;o<n.length;o+=1)n[o].l(l);l.forEach(h),this.h()},h(){f(e,"class","flex w-full h-64")},m(t,l){y(t,e,l);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null);s=!0},p(t,l){if(l&8){r=t[3];let o;for(o=0;o<r.length;o+=1){const u=P(t,r,o);n[o]?(n[o].p(u,l),k(n[o],1)):(n[o]=x(u),n[o].c(),k(n[o],1),n[o].m(e,null))}for(T(),o=r.length;o<n.length;o+=1)a(o);N()}},i(t){if(!s){for(let l=0;l<r.length;l+=1)k(n[l]);s=!0}},o(t){n=n.filter(Boolean);for(let l=0;l<n.length;l+=1)v(n[l]);s=!1},d(t){t&&h(e),z(n,t)}}}function x(i){let e,s;return e=new Q({props:{persona:i[8].persona,strokes:i[8].strokes}}),{c(){H(e.$$.fragment)},l(r){J(e.$$.fragment,r)},m(r,n){K(e,r,n),s=!0},p(r,n){const a={};n&8&&(a.persona=r[8].persona),n&8&&(a.strokes=r[8].strokes),e.$set(a)},i(r){s||(k(e.$$.fragment,r),s=!0)},o(r){v(e.$$.fragment,r),s=!1},d(r){U(e,r)}}}function $(i){let e,s,r,n;const a=[Z,Y],t=[];function l(o,u){return o[1]?0:1}return s=l(i),r=t[s]=a[s](i),{c(){e=d("div"),r.c(),this.h()},l(o){e=p(o,"DIV",{class:!0});var u=g(e);r.l(u),u.forEach(h),this.h()},h(){f(e,"class","w-full")},m(o,u){y(o,e,u),t[s].m(e,null),i[6](e),n=!0},p(o,[u]){let _=s;s=l(o),s===_?t[s].p(o,u):(T(),v(t[_],1,1,()=>{t[_]=null}),N(),r=t[s],r?r.p(o,u):(r=t[s]=a[s](o),r.c()),k(r,1),r.m(e,null))},i(o){n||(k(r),n=!0)},o(o){v(r),n=!1},d(o){o&&h(e),t[s].d(),i[6](null)}}}function ee(i,e,s){let r,n,a,t={},l=[];function o(){if(r==null){w("Error: Personas container not found.");return}if(a&&a.length>0){try{s(1,n=JSON.parse(a))}catch{w("Error: Could not parse input.");return}for(let c of n){const E=t[c.persona]||[];t[c.persona]=[...E,c]}s(3,l=Object.keys(t).map(c=>({persona:c,strokes:t[c]??[]})))}}function u(){a=this.value,s(2,a)}function _(c){R[c?"unshift":"push"](()=>{r=c,s(0,r)})}return[r,n,a,l,o,u,_]}class re extends D{constructor(e){super(),A(this,e,ee,$,S,{})}}export{re as default};
