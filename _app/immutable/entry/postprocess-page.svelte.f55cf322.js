var en=Object.defineProperty;var tn=(l,e,t)=>e in l?en(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var Ze=(l,e,t)=>(tn(l,typeof e!="symbol"?e+"":e,t),t);import{S as Ee,i as Pe,s as _e,k as B,q as ne,a as Q,l as $,m as R,r as se,h as m,c as Y,n as g,Y as ae,b as T,G as M,K as Ie,u as Oe,g as N,v as Ne,d as W,f as He,N as dt,a1 as nn,C as pt,D as gt,E as mt,F as _t,a2 as sn,w as ye,a3 as rn,R as ut,H as q,a4 as an,O as bt,o as st,P as it,e as Be,X as rt,a5 as Ct,p as ft,T as Ke,y as be,z as ve,A as ke,a6 as qt,a7 as Kt,B as we,J as qe,a8 as ln,a9 as on,U as tt,aa as yt,$ as De,a0 as Se}from"../chunks/index.87c45b08.js";import{j as cn,g as un,k as fn,p as vt,b as Xe,a as nt,e as Ge,r as Jt,d as Qt,P as me}from"../chunks/index.3e9be703.js";import{w as Ve}from"../chunks/index.4e444171.js";var Yt={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(l,e){(function(t,n){l.exports=n()})(cn,function t(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i=!n.document&&!!n.postMessage,s=n.IS_PAPA_WORKER||!1,a={},o=0,r={parse:function(f,h){var p=(h=h||{}).dynamicTyping||!1;if(S(p)&&(h.dynamicTypingFunction=p,p={}),h.dynamicTyping=p,h.transform=!!S(h.transform)&&h.transform,h.worker&&r.WORKERS_SUPPORTED){var w=function(){if(!r.WORKERS_SUPPORTED)return!1;var x=(le=n.URL||n.webkitURL||null,P=t.toString(),r.BLOB_URL||(r.BLOB_URL=le.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",P,")();"],{type:"text/javascript"})))),H=new n.Worker(x),le,P;return H.onmessage=U,H.id=o++,a[H.id]=H}();return w.userStep=h.step,w.userChunk=h.chunk,w.userComplete=h.complete,w.userError=h.error,h.step=S(h.step),h.chunk=S(h.chunk),h.complete=S(h.complete),h.error=S(h.error),delete h.worker,void w.postMessage({input:f,config:h,workerId:w.id})}var E=null;return r.NODE_STREAM_INPUT,typeof f=="string"?(f=function(x){return x.charCodeAt(0)===65279?x.slice(1):x}(f),E=h.download?new d(h):new C(h)):f.readable===!0&&S(f.read)&&S(f.on)?E=new L(h):(n.File&&f instanceof File||f instanceof Object)&&(E=new b(h)),E.stream(f)},unparse:function(f,h){var p=!1,w=!0,E=",",x=`\r
`,H='"',le=H+H,P=!1,_=null,V=!1;(function(){if(typeof h=="object"){if(typeof h.delimiter!="string"||r.BAD_DELIMITERS.filter(function(I){return h.delimiter.indexOf(I)!==-1}).length||(E=h.delimiter),(typeof h.quotes=="boolean"||typeof h.quotes=="function"||Array.isArray(h.quotes))&&(p=h.quotes),typeof h.skipEmptyLines!="boolean"&&typeof h.skipEmptyLines!="string"||(P=h.skipEmptyLines),typeof h.newline=="string"&&(x=h.newline),typeof h.quoteChar=="string"&&(H=h.quoteChar),typeof h.header=="boolean"&&(w=h.header),Array.isArray(h.columns)){if(h.columns.length===0)throw new Error("Option columns is empty");_=h.columns}h.escapeChar!==void 0&&(le=h.escapeChar+H),(typeof h.escapeFormulae=="boolean"||h.escapeFormulae instanceof RegExp)&&(V=h.escapeFormulae instanceof RegExp?h.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var A=new RegExp(j(H),"g");if(typeof f=="string"&&(f=JSON.parse(f)),Array.isArray(f)){if(!f.length||Array.isArray(f[0]))return X(null,f,P);if(typeof f[0]=="object")return X(_||Object.keys(f[0]),f,P)}else if(typeof f=="object")return typeof f.data=="string"&&(f.data=JSON.parse(f.data)),Array.isArray(f.data)&&(f.fields||(f.fields=f.meta&&f.meta.fields||_),f.fields||(f.fields=Array.isArray(f.data[0])?f.fields:typeof f.data[0]=="object"?Object.keys(f.data[0]):[]),Array.isArray(f.data[0])||typeof f.data[0]=="object"||(f.data=[f.data])),X(f.fields||[],f.data||[],P);throw new Error("Unable to serialize unrecognized input");function X(I,D,k){var y="";typeof I=="string"&&(I=JSON.parse(I)),typeof D=="string"&&(D=JSON.parse(D));var z=Array.isArray(I)&&0<I.length,ie=!Array.isArray(D[0]);if(z&&w){for(var ee=0;ee<I.length;ee++)0<ee&&(y+=E),y+=G(I[ee],ee);0<D.length&&(y+=x)}for(var O=0;O<D.length;O++){var J=z?I.length:D[O].length,ue=!1,ge=z?Object.keys(D[O]).length===0:D[O].length===0;if(k&&!z&&(ue=k==="greedy"?D[O].join("").trim()==="":D[O].length===1&&D[O][0].length===0),k==="greedy"&&z){for(var re=[],Ce=0;Ce<J;Ce++){var de=ie?I[Ce]:Ce;re.push(D[O][de])}ue=re.join("").trim()===""}if(!ue){for(var oe=0;oe<J;oe++){0<oe&&!ge&&(y+=E);var xe=z&&ie?I[oe]:oe;y+=G(D[O][xe],oe)}O<D.length-1&&(!k||0<J&&!ge)&&(y+=x)}}return y}function G(I,D){if(I==null)return"";if(I.constructor===Date)return JSON.stringify(I).slice(1,25);var k=!1;V&&typeof I=="string"&&V.test(I)&&(I="'"+I,k=!0);var y=I.toString().replace(A,le);return(k=k||p===!0||typeof p=="function"&&p(I,D)||Array.isArray(p)&&p[D]||function(z,ie){for(var ee=0;ee<ie.length;ee++)if(-1<z.indexOf(ie[ee]))return!0;return!1}(y,r.BAD_DELIMITERS)||-1<y.indexOf(E)||y.charAt(0)===" "||y.charAt(y.length-1)===" ")?H+y+H:y}}};if(r.RECORD_SEP=String.fromCharCode(30),r.UNIT_SEP=String.fromCharCode(31),r.BYTE_ORDER_MARK="\uFEFF",r.BAD_DELIMITERS=["\r",`
`,'"',r.BYTE_ORDER_MARK],r.WORKERS_SUPPORTED=!i&&!!n.Worker,r.NODE_STREAM_INPUT=1,r.LocalChunkSize=10485760,r.RemoteChunkSize=5242880,r.DefaultDelimiter=",",r.Parser=K,r.ParserHandle=F,r.NetworkStreamer=d,r.FileStreamer=b,r.StringStreamer=C,r.ReadableStreamStreamer=L,n.jQuery){var c=n.jQuery;c.fn.parse=function(f){var h=f.config||{},p=[];return this.each(function(x){if(!(c(this).prop("tagName").toUpperCase()==="INPUT"&&c(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var H=0;H<this.files.length;H++)p.push({file:this.files[H],inputElem:this,instanceConfig:c.extend({},h)})}),w(),this;function w(){if(p.length!==0){var x,H,le,P,_=p[0];if(S(f.before)){var V=f.before(_.file,_.inputElem);if(typeof V=="object"){if(V.action==="abort")return x="AbortError",H=_.file,le=_.inputElem,P=V.reason,void(S(f.error)&&f.error({name:x},H,le,P));if(V.action==="skip")return void E();typeof V.config=="object"&&(_.instanceConfig=c.extend(_.instanceConfig,V.config))}else if(V==="skip")return void E()}var A=_.instanceConfig.complete;_.instanceConfig.complete=function(X){S(A)&&A(X,_.file,_.inputElem),E()},r.parse(_.file,_.instanceConfig)}else S(f.complete)&&f.complete()}function E(){p.splice(0,1),w()}}}function u(f){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(h){var p=he(h);p.chunkSize=parseInt(p.chunkSize),h.step||h.chunk||(p.chunkSize=null),this._handle=new F(p),(this._handle.streamer=this)._config=p}.call(this,f),this.parseChunk=function(h,p){if(this.isFirstChunk&&S(this._config.beforeFirstChunk)){var w=this._config.beforeFirstChunk(h);w!==void 0&&(h=w)}this.isFirstChunk=!1,this._halted=!1;var E=this._partialLine+h;this._partialLine="";var x=this._handle.parse(E,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var H=x.meta.cursor;this._finished||(this._partialLine=E.substring(H-this._baseIndex),this._baseIndex=H),x&&x.data&&(this._rowCount+=x.data.length);var le=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)n.postMessage({results:x,workerId:r.WORKER_ID,finished:le});else if(S(this._config.chunk)&&!p){if(this._config.chunk(x,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);x=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(x.data),this._completeResults.errors=this._completeResults.errors.concat(x.errors),this._completeResults.meta=x.meta),this._completed||!le||!S(this._config.complete)||x&&x.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),le||x&&x.meta.paused||this._nextChunk(),x}this._halted=!0},this._sendError=function(h){S(this._config.error)?this._config.error(h):s&&this._config.error&&n.postMessage({workerId:r.WORKER_ID,error:h,finished:!1})}}function d(f){var h;(f=f||{}).chunkSize||(f.chunkSize=r.RemoteChunkSize),u.call(this,f),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(p){this._input=p,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(h=new XMLHttpRequest,this._config.withCredentials&&(h.withCredentials=this._config.withCredentials),i||(h.onload=v(this._chunkLoaded,this),h.onerror=v(this._chunkError,this)),h.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var p=this._config.downloadRequestHeaders;for(var w in p)h.setRequestHeader(w,p[w])}if(this._config.chunkSize){var E=this._start+this._config.chunkSize-1;h.setRequestHeader("Range","bytes="+this._start+"-"+E)}try{h.send(this._config.downloadRequestBody)}catch(x){this._chunkError(x.message)}i&&h.status===0&&this._chunkError()}},this._chunkLoaded=function(){h.readyState===4&&(h.status<200||400<=h.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:h.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(p){var w=p.getResponseHeader("Content-Range");return w===null?-1:parseInt(w.substring(w.lastIndexOf("/")+1))}(h),this.parseChunk(h.responseText)))},this._chunkError=function(p){var w=h.statusText||p;this._sendError(new Error(w))}}function b(f){var h,p;(f=f||{}).chunkSize||(f.chunkSize=r.LocalChunkSize),u.call(this,f);var w=typeof FileReader<"u";this.stream=function(E){this._input=E,p=E.slice||E.webkitSlice||E.mozSlice,w?((h=new FileReader).onload=v(this._chunkLoaded,this),h.onerror=v(this._chunkError,this)):h=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var E=this._input;if(this._config.chunkSize){var x=Math.min(this._start+this._config.chunkSize,this._input.size);E=p.call(E,this._start,x)}var H=h.readAsText(E,this._config.encoding);w||this._chunkLoaded({target:{result:H}})},this._chunkLoaded=function(E){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(E.target.result)},this._chunkError=function(){this._sendError(h.error)}}function C(f){var h;u.call(this,f=f||{}),this.stream=function(p){return h=p,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var p,w=this._config.chunkSize;return w?(p=h.substring(0,w),h=h.substring(w)):(p=h,h=""),this._finished=!h,this.parseChunk(p)}}}function L(f){u.call(this,f=f||{});var h=[],p=!0,w=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(E){this._input=E,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){w&&h.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),h.length?this.parseChunk(h.shift()):p=!0},this._streamData=v(function(E){try{h.push(typeof E=="string"?E:E.toString(this._config.encoding)),p&&(p=!1,this._checkIsFinished(),this.parseChunk(h.shift()))}catch(x){this._streamError(x)}},this),this._streamError=v(function(E){this._streamCleanUp(),this._sendError(E)},this),this._streamEnd=v(function(){this._streamCleanUp(),w=!0,this._streamData("")},this),this._streamCleanUp=v(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function F(f){var h,p,w,E=Math.pow(2,53),x=-E,H=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,le=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,P=this,_=0,V=0,A=!1,X=!1,G=[],I={data:[],errors:[],meta:{}};if(S(f.step)){var D=f.step;f.step=function(O){if(I=O,z())y();else{if(y(),I.data.length===0)return;_+=O.data.length,f.preview&&_>f.preview?p.abort():(I.data=I.data[0],D(I,P))}}}function k(O){return f.skipEmptyLines==="greedy"?O.join("").trim()==="":O.length===1&&O[0].length===0}function y(){return I&&w&&(ee("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+r.DefaultDelimiter+"'"),w=!1),f.skipEmptyLines&&(I.data=I.data.filter(function(O){return!k(O)})),z()&&function(){if(!I)return;function O(ue,ge){S(f.transformHeader)&&(ue=f.transformHeader(ue,ge)),G.push(ue)}if(Array.isArray(I.data[0])){for(var J=0;z()&&J<I.data.length;J++)I.data[J].forEach(O);I.data.splice(0,1)}else I.data.forEach(O)}(),function(){if(!I||!f.header&&!f.dynamicTyping&&!f.transform)return I;function O(ue,ge){var re,Ce=f.header?{}:[];for(re=0;re<ue.length;re++){var de=re,oe=ue[re];f.header&&(de=re>=G.length?"__parsed_extra":G[re]),f.transform&&(oe=f.transform(oe,de)),oe=ie(de,oe),de==="__parsed_extra"?(Ce[de]=Ce[de]||[],Ce[de].push(oe)):Ce[de]=oe}return f.header&&(re>G.length?ee("FieldMismatch","TooManyFields","Too many fields: expected "+G.length+" fields but parsed "+re,V+ge):re<G.length&&ee("FieldMismatch","TooFewFields","Too few fields: expected "+G.length+" fields but parsed "+re,V+ge)),Ce}var J=1;return!I.data.length||Array.isArray(I.data[0])?(I.data=I.data.map(O),J=I.data.length):I.data=O(I.data,0),f.header&&I.meta&&(I.meta.fields=G),V+=J,I}()}function z(){return f.header&&G.length===0}function ie(O,J){return ue=O,f.dynamicTypingFunction&&f.dynamicTyping[ue]===void 0&&(f.dynamicTyping[ue]=f.dynamicTypingFunction(ue)),(f.dynamicTyping[ue]||f.dynamicTyping)===!0?J==="true"||J==="TRUE"||J!=="false"&&J!=="FALSE"&&(function(ge){if(H.test(ge)){var re=parseFloat(ge);if(x<re&&re<E)return!0}return!1}(J)?parseFloat(J):le.test(J)?new Date(J):J===""?null:J):J;var ue}function ee(O,J,ue,ge){var re={type:O,code:J,message:ue};ge!==void 0&&(re.row=ge),I.errors.push(re)}this.parse=function(O,J,ue){var ge=f.quoteChar||'"';if(f.newline||(f.newline=function(de,oe){de=de.substring(0,1048576);var xe=new RegExp(j(oe)+"([^]*?)"+j(oe),"gm"),Ae=(de=de.replace(xe,"")).split("\r"),Re=de.split(`
`),$e=1<Re.length&&Re[0].length<Ae[0].length;if(Ae.length===1||$e)return`
`;for(var Me=0,fe=0;fe<Ae.length;fe++)Ae[fe][0]===`
`&&Me++;return Me>=Ae.length/2?`\r
`:"\r"}(O,ge)),w=!1,f.delimiter)S(f.delimiter)&&(f.delimiter=f.delimiter(O),I.meta.delimiter=f.delimiter);else{var re=function(de,oe,xe,Ae,Re){var $e,Me,fe,pe;Re=Re||[",","	","|",";",r.RECORD_SEP,r.UNIT_SEP];for(var Je=0;Je<Re.length;Je++){var te=Re[Je],Ye=0,ze=0,Qe=0;fe=void 0;for(var je=new K({comments:Ae,delimiter:te,newline:oe,preview:10}).parse(de),Ue=0;Ue<je.data.length;Ue++)if(xe&&k(je.data[Ue]))Qe++;else{var We=je.data[Ue].length;ze+=We,fe!==void 0?0<We&&(Ye+=Math.abs(We-fe),fe=We):fe=We}0<je.data.length&&(ze/=je.data.length-Qe),(Me===void 0||Ye<=Me)&&(pe===void 0||pe<ze)&&1.99<ze&&(Me=Ye,$e=te,pe=ze)}return{successful:!!(f.delimiter=$e),bestDelimiter:$e}}(O,f.newline,f.skipEmptyLines,f.comments,f.delimitersToGuess);re.successful?f.delimiter=re.bestDelimiter:(w=!0,f.delimiter=r.DefaultDelimiter),I.meta.delimiter=f.delimiter}var Ce=he(f);return f.preview&&f.header&&Ce.preview++,h=O,p=new K(Ce),I=p.parse(h,J,ue),y(),A?{meta:{paused:!0}}:I||{meta:{paused:!1}}},this.paused=function(){return A},this.pause=function(){A=!0,p.abort(),h=S(f.chunk)?"":h.substring(p.getCharIndex())},this.resume=function(){P.streamer._halted?(A=!1,P.streamer.parseChunk(h,!0)):setTimeout(P.resume,3)},this.aborted=function(){return X},this.abort=function(){X=!0,p.abort(),I.meta.aborted=!0,S(f.complete)&&f.complete(I),h=""}}function j(f){return f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function K(f){var h,p=(f=f||{}).delimiter,w=f.newline,E=f.comments,x=f.step,H=f.preview,le=f.fastMode,P=h=f.quoteChar===void 0||f.quoteChar===null?'"':f.quoteChar;if(f.escapeChar!==void 0&&(P=f.escapeChar),(typeof p!="string"||-1<r.BAD_DELIMITERS.indexOf(p))&&(p=","),E===p)throw new Error("Comment character same as delimiter");E===!0?E="#":(typeof E!="string"||-1<r.BAD_DELIMITERS.indexOf(E))&&(E=!1),w!==`
`&&w!=="\r"&&w!==`\r
`&&(w=`
`);var _=0,V=!1;this.parse=function(A,X,G){if(typeof A!="string")throw new Error("Input must be a string");var I=A.length,D=p.length,k=w.length,y=E.length,z=S(x),ie=[],ee=[],O=[],J=_=0;if(!A)return Fe();if(f.header&&!X){var ue=A.split(w)[0].split(p),ge=[],re={},Ce=!1;for(var de in ue){var oe=ue[de];S(f.transformHeader)&&(oe=f.transformHeader(oe,de));var xe=oe,Ae=re[oe]||0;for(0<Ae&&(Ce=!0,xe=oe+"_"+Ae),re[oe]=Ae+1;ge.includes(xe);)xe=xe+"_"+Ae;ge.push(xe)}if(Ce){var Re=A.split(w);Re[0]=ge.join(p),A=Re.join(w)}}if(le||le!==!1&&A.indexOf(h)===-1){for(var $e=A.split(w),Me=0;Me<$e.length;Me++){if(O=$e[Me],_+=O.length,Me!==$e.length-1)_+=w.length;else if(G)return Fe();if(!E||O.substring(0,y)!==E){if(z){if(ie=[],Qe(O.split(p)),at(),V)return Fe()}else Qe(O.split(p));if(H&&H<=Me)return ie=ie.slice(0,H),Fe(!0)}}return Fe()}for(var fe=A.indexOf(p,_),pe=A.indexOf(w,_),Je=new RegExp(j(P)+j(h),"g"),te=A.indexOf(h,_);;)if(A[_]!==h)if(E&&O.length===0&&A.substring(_,_+y)===E){if(pe===-1)return Fe();_=pe+k,pe=A.indexOf(w,_),fe=A.indexOf(p,_)}else if(fe!==-1&&(fe<pe||pe===-1))O.push(A.substring(_,fe)),_=fe+D,fe=A.indexOf(p,_);else{if(pe===-1)break;if(O.push(A.substring(_,pe)),We(pe+k),z&&(at(),V))return Fe();if(H&&ie.length>=H)return Fe(!0)}else for(te=_,_++;;){if((te=A.indexOf(h,te+1))===-1)return G||ee.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ie.length,index:_}),Ue();if(te===I-1)return Ue(A.substring(_,te).replace(Je,h));if(h!==P||A[te+1]!==P){if(h===P||te===0||A[te-1]!==P){fe!==-1&&fe<te+1&&(fe=A.indexOf(p,te+1)),pe!==-1&&pe<te+1&&(pe=A.indexOf(w,te+1));var Ye=je(pe===-1?fe:Math.min(fe,pe));if(A.substr(te+1+Ye,D)===p){O.push(A.substring(_,te).replace(Je,h)),A[_=te+1+Ye+D]!==h&&(te=A.indexOf(h,_)),fe=A.indexOf(p,_),pe=A.indexOf(w,_);break}var ze=je(pe);if(A.substring(te+1+ze,te+1+ze+k)===w){if(O.push(A.substring(_,te).replace(Je,h)),We(te+1+ze+k),fe=A.indexOf(p,_),te=A.indexOf(h,_),z&&(at(),V))return Fe();if(H&&ie.length>=H)return Fe(!0);break}ee.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ie.length,index:_}),te++}}else te++}return Ue();function Qe(Te){ie.push(Te),J=_}function je(Te){var wt=0;if(Te!==-1){var ot=A.substring(te+1,Te);ot&&ot.trim()===""&&(wt=ot.length)}return wt}function Ue(Te){return G||(Te===void 0&&(Te=A.substring(_)),O.push(Te),_=I,Qe(O),z&&at()),Fe()}function We(Te){_=Te,Qe(O),O=[],pe=A.indexOf(w,_)}function Fe(Te){return{data:ie,errors:ee,meta:{delimiter:p,linebreak:w,aborted:V,truncated:!!Te,cursor:J+(X||0)}}}function at(){x(Fe()),ie=[],ee=[]}},this.abort=function(){V=!0},this.getCharIndex=function(){return _}}function U(f){var h=f.data,p=a[h.workerId],w=!1;if(h.error)p.userError(h.error,h.file);else if(h.results&&h.results.data){var E={abort:function(){w=!0,ce(h.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Z,resume:Z};if(S(p.userStep)){for(var x=0;x<h.results.data.length&&(p.userStep({data:h.results.data[x],errors:h.results.errors,meta:h.results.meta},E),!w);x++);delete h.results}else S(p.userChunk)&&(p.userChunk(h.results,E,h.file),delete h.results)}h.finished&&!w&&ce(h.workerId,h.results)}function ce(f,h){var p=a[f];S(p.userComplete)&&p.userComplete(h),p.terminate(),delete a[f]}function Z(){throw new Error("Not implemented.")}function he(f){if(typeof f!="object"||f===null)return f;var h=Array.isArray(f)?[]:{};for(var p in f)h[p]=he(f[p]);return h}function v(f,h){return function(){f.apply(h,arguments)}}function S(f){return typeof f=="function"}return s&&(n.onmessage=function(f){var h=f.data;if(r.WORKER_ID===void 0&&h&&(r.WORKER_ID=h.workerId),typeof h.input=="string")n.postMessage({workerId:r.WORKER_ID,results:r.parse(h.input,h.config),finished:!0});else if(n.File&&h.input instanceof File||h.input instanceof Object){var p=r.parse(h.input,h.config);p&&n.postMessage({workerId:r.WORKER_ID,results:p,finished:!0})}}),(d.prototype=Object.create(u.prototype)).constructor=d,(b.prototype=Object.create(u.prototype)).constructor=b,(C.prototype=Object.create(C.prototype)).constructor=C,(L.prototype=Object.create(u.prototype)).constructor=L,r})})(Yt);var hn=Yt.exports;const Et=un(hn),lt={selectedParticipantIdx:Ve(0)},et={mapColors:{FemaleFront:Ve("#0000FF"),FemaleBack:Ve("#0000FF"),MaleFront:Ve("#0000FF"),MaleBack:Ve("#0000FF")}},dn={mapColors:{FemaleFront:Ve("#0000FF"),FemaleBack:Ve("#0000FF"),MaleFront:Ve("#0000FF"),MaleBack:Ve("#0000FF")}};function Pt(l){let e,t,n;const i=l[8].default,s=pt(i,l,l[7],null);return{c(){e=B("ul"),s&&s.c(),this.h()},l(a){e=$(a,"UL",{class:!0});var o=R(e);s&&s.l(o),o.forEach(m),this.h()},h(){g(e,"class","absolute top-full left-0 w-48 p-1 bg-neutral-700 shadow")},m(a,o){T(a,e,o),s&&s.m(e,null),n=!0},p(a,o){s&&s.p&&(!n||o&128)&&gt(s,i,a,a[7],n?_t(i,a[7],o,null):mt(a[7]),null)},i(a){n||(N(s,a),t&&t.end(1),n=!0)},o(a){W(s,a),t=sn(e,fn,{duration:100}),n=!1},d(a){a&&m(e),s&&s.d(a),a&&t&&t.end()}}}function pn(l){let e,t,n,i,s,a,o,r=l[0]&&Pt(l);return{c(){e=B("div"),t=B("button"),n=ne(l[1]),i=Q(),r&&r.c(),this.h()},l(c){e=$(c,"DIV",{class:!0});var u=R(e);t=$(u,"BUTTON",{class:!0});var d=R(t);n=se(d,l[1]),d.forEach(m),i=Y(u),r&&r.l(u),u.forEach(m),this.h()},h(){g(t,"class","h-full px-3 text-neutral-100 text-xs"),ae(t,"bg-neutral-700",l[0]),g(e,"class","relative flex items-center h-full")},m(c,u){T(c,e,u),M(e,t),M(t,n),M(e,i),r&&r.m(e,null),l[9](e),s=!0,a||(o=[Ie(window,"click",l[4]),Ie(t,"click",l[3])],a=!0)},p(c,[u]){(!s||u&2)&&Oe(n,c[1]),(!s||u&1)&&ae(t,"bg-neutral-700",c[0]),c[0]?r?(r.p(c,u),u&1&&N(r,1)):(r=Pt(c),r.c(),N(r,1),r.m(e,null)):r&&(Ne(),W(r,1,1,()=>{r=null}),He())},i(c){s||(N(r),s=!0)},o(c){W(r),s=!1},d(c){c&&m(e),r&&r.d(),l[9](null),a=!1,dt(o)}}}function gn(l,e,t){let{$$slots:n={},$$scope:i}=e,{title:s}=e,{isOpen:a=!1}=e,{enableIcon:o=!1}=e;function r(){t(0,a=!1)}let c;nn("menu",{enableIcon:o});function u(){t(0,a=!a)}function d(C){C.target instanceof Node&&c.contains(C.target)===!1&&t(0,a=!1)}function b(C){ye[C?"unshift":"push"](()=>{c=C,t(2,c)})}return l.$$set=C=>{"title"in C&&t(1,s=C.title),"isOpen"in C&&t(0,a=C.isOpen),"enableIcon"in C&&t(5,o=C.enableIcon),"$$scope"in C&&t(7,i=C.$$scope)},[a,s,c,u,d,o,r,i,n,b]}class ht extends Ee{constructor(e){super(),Pe(this,e,gn,pn,_e,{title:1,isOpen:0,enableIcon:5,close:6})}get close(){return this.$$.ctx[6]}}const mn=l=>({isActive:l&1}),Dt=l=>({isActive:l[0]});function _n(l){let e,t;const n=l[3].icon,i=pt(n,l,l[2],Dt);return{c(){e=B("span"),i&&i.c(),this.h()},l(s){e=$(s,"SPAN",{class:!0});var a=R(e);i&&i.l(a),a.forEach(m),this.h()},h(){g(e,"class","w-[16px] mr-1")},m(s,a){T(s,e,a),i&&i.m(e,null),t=!0},p(s,a){i&&i.p&&(!t||a&5)&&gt(i,n,s,s[2],t?_t(n,s[2],a,mn):mt(s[2]),Dt)},i(s){t||(N(i,s),t=!0)},o(s){W(i,s),t=!1},d(s){s&&m(e),i&&i.d(s)}}}function bn(l){let e,t,n,i,s,a,o=l[1]&&_n(l);const r=l[3].default,c=pt(r,l,l[2],null);return{c(){e=B("li"),t=B("button"),o&&o.c(),n=Q(),c&&c.c(),this.h()},l(u){e=$(u,"LI",{class:!0});var d=R(e);t=$(d,"BUTTON",{class:!0});var b=R(t);o&&o.l(b),n=Y(b),c&&c.l(b),b.forEach(m),d.forEach(m),this.h()},h(){g(t,"class","flex items-center w-full py-1 pr-2 "+(l[1]?"pl-1":"pl-2")+" text-xs text-neutral-100 text-left"),ae(t,"hover:bg-blue-500",!l[0]),g(e,"class","w-full")},m(u,d){T(u,e,d),M(e,t),o&&o.m(t,null),M(t,n),c&&c.m(t,null),i=!0,s||(a=Ie(e,"click",l[4]),s=!0)},p(u,[d]){u[1]&&o.p(u,d),c&&c.p&&(!i||d&4)&&gt(c,r,u,u[2],i?_t(r,u[2],d,null):mt(u[2]),null),(!i||d&1)&&ae(t,"hover:bg-blue-500",!u[0])},i(u){i||(N(o),N(c,u),i=!0)},o(u){W(o),W(c,u),i=!1},d(u){u&&m(e),o&&o.d(),c&&c.d(u),s=!1,a()}}}function vn(l,e,t){let{$$slots:n={},$$scope:i}=e,{isActive:s=!1}=e;const{enableIcon:a}=rn("menu");function o(r){ut.call(this,l,r)}return l.$$set=r=>{"isActive"in r&&t(0,s=r.isActive),"$$scope"in r&&t(2,i=r.$$scope)},[s,a,i,n,o]}class Le extends Ee{constructor(e){super(),Pe(this,e,vn,bn,_e,{isActive:0})}}function kn(l){let e;return{c(){e=B("hr"),this.h()},l(t){e=$(t,"HR",{class:!0}),this.h()},h(){g(e,"class","my-0.5 border-0 border-b border-neutral-600")},m(t,n){T(t,e,n)},p:q,i:q,o:q,d(t){t&&m(e)}}}class wn extends Ee{constructor(e){super(),Pe(this,e,null,kn,_e,{})}}function St(l,e,t){const n=l.slice();return n[23]=e[t],n}function It(l){let e,t=l[23].title+"",n,i,s,a,o;function r(){return l[15](l[23])}return{c(){e=B("button"),n=ne(t),i=Q(),this.h()},l(c){e=$(c,"BUTTON",{class:!0});var u=R(e);n=se(u,t),i=Y(u),u.forEach(m),this.h()},h(){g(e,"class",s=Ct(l[23].isDisabled?"hidden":"panel-tab")+" svelte-1oevamb"),ae(e,"panel-config",l[1]&&l[6]===l[23]),ae(e,"active",l[6]===l[23]),ae(e,"active-panel",l[5]&&l[6]===l[23])},m(c,u){T(c,e,u),M(e,n),M(e,i),a||(o=Ie(e,"click",r),a=!0)},p(c,u){l=c,u&1&&t!==(t=l[23].title+"")&&Oe(n,t),u&1&&s!==(s=Ct(l[23].isDisabled?"hidden":"panel-tab")+" svelte-1oevamb")&&g(e,"class",s),u&67&&ae(e,"panel-config",l[1]&&l[6]===l[23]),u&65&&ae(e,"active",l[6]===l[23]),u&97&&ae(e,"active-panel",l[5]&&l[6]===l[23])},d(c){c&&m(e),a=!1,o()}}}function At(l){let e,t=l[0],n=[];for(let i=0;i<t.length;i+=1)n[i]=It(St(l,t,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=Be()},l(i){for(let s=0;s<n.length;s+=1)n[s].l(i);e=Be()},m(i,s){for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(i,s);T(i,e,s)},p(i,s){if(s&355){t=i[0];let a;for(a=0;a<t.length;a+=1){const o=St(i,t,a);n[a]?n[a].p(o,s):(n[a]=It(o),n[a].c(),n[a].m(e.parentNode,e))}for(;a<n.length;a+=1)n[a].d(1);n.length=t.length}},d(i){rt(n,i),i&&m(e)}}}function Mt(l){let e,t;return{c(){e=B("span"),t=ne(l[2]),this.h()},l(n){e=$(n,"SPAN",{class:!0});var i=R(e);t=se(i,l[2]),i.forEach(m),this.h()},h(){g(e,"class","absolute top-4 right-4 py-1 px-2 bg-neutral-900 shadow bg-opacity-50 text-neutral-100 text-xs")},m(n,i){T(n,e,i),M(e,t),l[16](e)},p(n,i){i&4&&Oe(t,n[2])},d(n){n&&m(e),l[16](null)}}}function Cn(l){let e,t,n=l[5],i,s,a,o,r=At(l),c=l[2]&&Mt(l);return{c(){e=B("div"),t=B("div"),r.c(),i=Q(),s=B("div"),c&&c.c(),this.h()},l(u){e=$(u,"DIV",{class:!0});var d=R(e);t=$(d,"DIV",{class:!0});var b=R(t);r.l(b),b.forEach(m),i=Y(d),s=$(d,"DIV",{class:!0});var C=R(s);c&&c.l(C),C.forEach(m),d.forEach(m),this.h()},h(){g(t,"class","panel-tabs w-full h-5 svelte-1oevamb"),g(s,"class","panel relative flex-grow w-full"),g(e,"class","panel-container svelte-1oevamb")},m(u,d){T(u,e,d),M(e,t),r.m(t,null),M(e,i),M(e,s),c&&c.m(s,null),l[17](s),a||(o=Ie(e,"click",l[7]),a=!0)},p(u,[d]){d&32&&_e(n,n=u[5])?(r.d(1),r=At(u),r.c(),r.m(t,null)):r.p(u,d),u[2]?c?c.p(u,d):(c=Mt(u),c.c(),c.m(s,null)):c&&(c.d(1),c=null)},i:q,o:q,d(u){u&&m(e),r.d(u),c&&c.d(),l[17](null),a=!1,o()}}}function yn(l,e,t){let{tabs:n}=e,{isConfig:i=!1}=e,{caption:s=void 0}=e;function a(){let p;j.getConfigPanelsProps&&(p=j.getConfigPanelsProps()),t(5,F=!0),U("activePanelChange",{source:b,configPanelsProps:p})}function o(){t(5,F=!1)}function r(p){ce(),j=Z(p),t(6,K=p),i===!1&&a()}function c(p){const w=p.find(E=>E.title===K.title);if(w===void 0||w.isDisabled){const E=p.find(x=>x.isDisabled===!1);if(E)r(E);else throw"Error: All tabs are disabled, could not activate any tab."}t(0,n=p)}function u(){return K}function d(){return j}let b=an(),C,L,F=!1,j,K=n[0];const U=bt();function ce(){j.$destroy()}function Z(p){return new p.component({target:C,anchor:L,props:p.props})}function he(){i===!1&&a()}function v(p){r(p)}st(()=>{j=Z(K)}),it(()=>{j.$destroy()});const S=p=>v(p);function f(p){ye[p?"unshift":"push"](()=>{L=p,t(4,L)})}function h(p){ye[p?"unshift":"push"](()=>{C=p,t(3,C)})}return l.$$set=p=>{"tabs"in p&&t(0,n=p.tabs),"isConfig"in p&&t(1,i=p.isConfig),"caption"in p&&t(2,s=p.caption)},[n,i,s,C,L,F,K,he,v,a,o,r,c,u,d,S,f,h]}class En extends Ee{constructor(e){super(),Pe(this,e,yn,Cn,_e,{tabs:0,isConfig:1,caption:2,activate:9,deactivate:10,activateTab:11,updateTabs:12,getActiveTab:13,getActiveComponent:14})}get activate(){return this.$$.ctx[9]}get deactivate(){return this.$$.ctx[10]}get activateTab(){return this.$$.ctx[11]}get updateTabs(){return this.$$.ctx[12]}get getActiveTab(){return this.$$.ctx[13]}get getActiveComponent(){return this.$$.ctx[14]}}function Pn(l){let e,t,n,i;return{c(){e=B("section"),t=B("main"),n=Q(),i=B("aside"),this.h()},l(s){e=$(s,"SECTION",{class:!0});var a=R(e);t=$(a,"MAIN",{class:!0});var o=R(t);o.forEach(m),n=Y(a),i=$(a,"ASIDE",{class:!0,style:!0}),R(i).forEach(m),a.forEach(m),this.h()},h(){g(t,"class","flex-grow grid gap-[2px] bg-neutral-600"),ae(t,"grid-cols-1",l[4]==="single"),ae(t,"grid-rows-1",l[4]==="single"||l[4]==="dual"),ae(t,"grid-cols-2",l[4]==="dual"||l[4]==="grid"),ae(t,"grid-rows-2",l[4]==="grid"),g(i,"class","flex flex-col h-full bg-neutral-600 border-l border-neutral-900"),ft(i,"width",l[0]),ae(i,"hidden",l[3].length===0),g(e,"class","w-full h-full flex items-stretch")},m(s,a){T(s,e,a),M(e,t),l[10](t),M(e,n),M(e,i),l[11](i)},p(s,[a]){a&16&&ae(t,"grid-cols-1",s[4]==="single"),a&16&&ae(t,"grid-rows-1",s[4]==="single"||s[4]==="dual"),a&16&&ae(t,"grid-cols-2",s[4]==="dual"||s[4]==="grid"),a&16&&ae(t,"grid-rows-2",s[4]==="grid"),a&1&&ft(i,"width",s[0]),a&8&&ae(i,"hidden",s[3].length===0)},i:q,o:q,d(s){s&&m(e),l[10](null),l[11](null)}}}function Dn(l){switch(l){case"single":return 1;case"dual":return 2;case"grid":return 4}}function Sn(l,e,t){let{sidebarWidth:n="18rem"}=e,{defaultPanelProps:i}=e;function s(v){const f=Dn(v)-b.length,h=K(b,f);(F===void 0||!h.includes(F))&&h[0].activate(),t(4,L=v),b=h}function a(v){b=[],t(5,i=v),s(L)}function o(v){const S=i.tabs.map(f=>(v.includes(f.title)?f.isDisabled=!1:f.isDisabled=!0,f));b.forEach(f=>f.updateTabs(S)),t(5,i.tabs=S,i)}function r(){return F==null?void 0:F.getActiveComponent()}const c=bt();let u,d,b=[],C=[],L="single",F;function j(v,S){const f=new En({target:S??u,props:v});return f.$on("activePanelChange",ce),f}function K(v,S){let f;return S<0?(v.slice(S).forEach(p=>p.$destroy()),f=v.slice(0,S)):f=U(v,S),f}function U(v,S){const f=v.slice(0,S),h=v.map(p=>p.getActiveTab().title);for(let p=0;p<S;++p){const w=j(i),E=i.tabs.find(x=>h.includes(x.title)===!1);E&&(h.push(E.title),w.activateTab(E)),f.push(w)}return f}function ce({detail:v}){const S=v.source,f=v.configPanelsProps;if(C.forEach(h=>h.$destroy()),f){const h=[];for(let p of f){const w=j(p,d);h.push(w)}t(3,C=h)}F!=null&&F.deactivate&&F!==S&&F.deactivate(),F=S}st(()=>{s(L)}),it(()=>{for(let v of C)v.$destroy();for(let v of b)v.$destroy();c("destroy")});function Z(v){ye[v?"unshift":"push"](()=>{u=v,t(1,u)})}function he(v){ye[v?"unshift":"push"](()=>{d=v,t(2,d)})}return l.$$set=v=>{"sidebarWidth"in v&&t(0,n=v.sidebarWidth),"defaultPanelProps"in v&&t(5,i=v.defaultPanelProps)},[n,u,d,C,L,i,s,a,o,r,Z,he]}class In extends Ee{constructor(e){super(),Pe(this,e,Sn,Pn,_e,{sidebarWidth:0,defaultPanelProps:5,setView:6,setDefaultPanel:7,enableTabs:8,getActiveComponent:9})}get setView(){return this.$$.ctx[6]}get setDefaultPanel(){return this.$$.ctx[7]}get enableTabs(){return this.$$.ctx[8]}get getActiveComponent(){return this.$$.ctx[9]}}function An(l){let e;return{c(){e=B("ul"),this.h()},l(t){e=$(t,"UL",{class:!0}),R(e).forEach(m),this.h()},h(){g(e,"class","p-2")},m(t,n){T(t,e,n),l[3](e)},p:q,i:q,o:q,d(t){t&&m(e),l[3](null)}}}function Mn(l,e,t){let{fields:n}=e,{onFieldMount:i}=e,s,a={};st(()=>{for(let r of n){const c=document.createElement("li");c.classList.add("py-1");const u=new r.component({target:c,props:r.props});s.append(c),i(r.id,u),a[r.id]=u}});function o(r){ye[r?"unshift":"push"](()=>{s=r,t(0,s)})}return l.$$set=r=>{"fields"in r&&t(1,n=r.fields),"onFieldMount"in r&&t(2,i=r.onFieldMount)},[s,n,i,o]}class kt extends Ee{constructor(e){super(),Pe(this,e,Mn,An,_e,{fields:1,onFieldMount:2})}}function Ft(l,e,t){const n=l.slice();return n[5]=e[t],n[7]=t,n}function Tt(l){let e,t=l[5]+"",n,i;return{c(){e=B("option"),n=ne(t),this.h()},l(s){e=$(s,"OPTION",{});var a=R(e);n=se(a,t),a.forEach(m),this.h()},h(){e.__value=l[7],e.value=e.__value,e.selected=i=l[2]===l[7]},m(s,a){T(s,e,a),M(e,n)},p(s,a){a&2&&t!==(t=s[5]+"")&&Oe(n,t),a&4&&i!==(i=s[2]===s[7])&&(e.selected=i)},d(s){s&&m(e)}}}function Fn(l){let e,t,n,i,s,a,o,r=l[1],c=[];for(let u=0;u<r.length;u+=1)c[u]=Tt(Ft(l,r,u));return{c(){e=B("label"),t=ne(l[0]),n=ne(":"),i=Q(),s=B("select");for(let u=0;u<c.length;u+=1)c[u].c();this.h()},l(u){e=$(u,"LABEL",{class:!0});var d=R(e);t=se(d,l[0]),n=se(d,":"),d.forEach(m),i=Y(u),s=$(u,"SELECT",{name:!0,id:!0,class:!0});var b=R(s);for(let C=0;C<c.length;C+=1)c[C].l(b);b.forEach(m),this.h()},h(){g(e,"class","w-1/3 pr-2 text-xs text-neutral-400 text-right"),g(s,"name",l[0]),g(s,"id",l[0]),g(s,"class","emboss py-1 px-2 bg-neutral-700 border border-neutral-800 text-xs text-neutral-200")},m(u,d){T(u,e,d),M(e,t),M(e,n),T(u,i,d),T(u,s,d);for(let b=0;b<c.length;b+=1)c[b]&&c[b].m(s,null);a||(o=Ie(s,"change",l[3]),a=!0)},p(u,[d]){if(d&1&&Oe(t,u[0]),d&6){r=u[1];let b;for(b=0;b<r.length;b+=1){const C=Ft(u,r,b);c[b]?c[b].p(C,d):(c[b]=Tt(C),c[b].c(),c[b].m(s,null))}for(;b<c.length;b+=1)c[b].d(1);c.length=r.length}d&1&&g(s,"name",u[0]),d&1&&g(s,"id",u[0])},i:q,o:q,d(u){u&&m(e),u&&m(i),u&&m(s),rt(c,u),a=!1,o()}}}function Tn(l,e,t){let{name:n}=e,{options:i}=e,{selected:s=void 0}=e,{onChange:a}=e;function o(r){if(r.target){const c=r.target;a(c.value)}}return l.$$set=r=>{"name"in r&&t(0,n=r.name),"options"in r&&t(1,i=r.options),"selected"in r&&t(2,s=r.selected),"onChange"in r&&t(4,a=r.onChange)},[n,i,s,o,a]}class xn extends Ee{constructor(e){super(),Pe(this,e,Tn,Fn,_e,{name:0,options:1,selected:2,onChange:4})}}function Rn(l){let e;return{c(){e=B("td"),this.h()},l(t){e=$(t,"TD",{class:!0});var n=R(e);n.forEach(m),this.h()},h(){g(e,"class","py-1 px-2 border-l border-neutral-800 text-neutral-100 text-xs")},m(t,n){T(t,e,n),e.innerHTML=l[0]},p(t,[n]){n&1&&(e.innerHTML=t[0])},i:q,o:q,d(t){t&&m(e)}}}function Ln(l,e,t){let{value:n}=e,{formatter:i=void 0}=e,s;if(i)s=i(n);else if(typeof n=="string")s=n;else if(n.toString)s=n.toString();else throw"Error: Cannot format value.";return l.$$set=a=>{"value"in a&&t(1,n=a.value),"formatter"in a&&t(2,i=a.formatter)},[s,n,i]}class On extends Ee{constructor(e){super(),Pe(this,e,Ln,Rn,_e,{value:1,formatter:2})}}function xt(l,e,t){const n=l.slice();return n[3]=e[t],n}function Rt(l){let e,t;const n=[l[3]];let i={};for(let s=0;s<n.length;s+=1)i=Ke(i,n[s]);return e=new On({props:i}),{c(){be(e.$$.fragment)},l(s){ve(e.$$.fragment,s)},m(s,a){ke(e,s,a),t=!0},p(s,a){const o=a&1?qt(n,[Kt(s[3])]):{};e.$set(o)},i(s){t||(N(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){we(e,s)}}}function Bn(l){let e,t,n,i,s=l[0],a=[];for(let r=0;r<s.length;r+=1)a[r]=Rt(xt(l,s,r));const o=r=>W(a[r],1,1,()=>{a[r]=null});return{c(){e=B("tr");for(let r=0;r<a.length;r+=1)a[r].c();this.h()},l(r){e=$(r,"TR",{class:!0});var c=R(e);for(let u=0;u<a.length;u+=1)a[u].l(c);c.forEach(m),this.h()},h(){g(e,"class","hover:bg-neutral-600 border-b last:border-b-0 border-neutral-800")},m(r,c){T(r,e,c);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(e,null);t=!0,n||(i=[Ie(e,"mouseenter",l[1]),Ie(e,"mouseleave",l[2])],n=!0)},p(r,[c]){if(c&1){s=r[0];let u;for(u=0;u<s.length;u+=1){const d=xt(r,s,u);a[u]?(a[u].p(d,c),N(a[u],1)):(a[u]=Rt(d),a[u].c(),N(a[u],1),a[u].m(e,null))}for(Ne(),u=s.length;u<a.length;u+=1)o(u);He()}},i(r){if(!t){for(let c=0;c<s.length;c+=1)N(a[c]);t=!0}},o(r){a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)W(a[c]);t=!1},d(r){r&&m(e),rt(a,r),n=!1,dt(i)}}}function $n(l,e,t){let{cells:n}=e;function i(a){ut.call(this,l,a)}function s(a){ut.call(this,l,a)}return l.$$set=a=>{"cells"in a&&t(0,n=a.cells)},[n,i,s]}class zn extends Ee{constructor(e){super(),Pe(this,e,$n,Bn,_e,{cells:0})}}function Lt(l,e,t){const n=l.slice();return n[9]=e[t],n[11]=t,n}function Ot(l,e,t){const n=l.slice();return n[12]=e[t],n}function Bt(l){let e,t,n=l[1],i=[];for(let s=0;s<n.length;s+=1)i[s]=$t(Ot(l,n,s));return{c(){e=B("thead"),t=B("tr");for(let s=0;s<i.length;s+=1)i[s].c();this.h()},l(s){e=$(s,"THEAD",{});var a=R(e);t=$(a,"TR",{class:!0});var o=R(t);for(let r=0;r<i.length;r+=1)i[r].l(o);o.forEach(m),a.forEach(m),this.h()},h(){g(t,"class","bg-gradient-to-t from-neutral-600 to-neutral-500 border-b border-neutral-800")},m(s,a){T(s,e,a),M(e,t);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(t,null)},p(s,a){if(a&2){n=s[1];let o;for(o=0;o<n.length;o+=1){const r=Ot(s,n,o);i[o]?i[o].p(r,a):(i[o]=$t(r),i[o].c(),i[o].m(t,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}},d(s){s&&m(e),rt(i,s)}}}function $t(l){let e,t=l[12]+"",n;return{c(){e=B("th"),n=ne(t),this.h()},l(i){e=$(i,"TH",{class:!0});var s=R(e);n=se(s,t),s.forEach(m),this.h()},h(){g(e,"class","px-2 border-l border-neutral-800 text-neutral-300 text-[0.6875rem] font-medium lowercase small-caps svelte-2meyxc")},m(i,s){T(i,e,s),M(e,n)},p(i,s){s&2&&t!==(t=i[12]+"")&&Oe(n,t)},d(i){i&&m(e)}}}function zt(l){let e,t;const n=[l[9]];function i(){return l[6](l[11])}function s(){return l[7](l[11])}let a={};for(let o=0;o<n.length;o+=1)a=Ke(a,n[o]);return e=new zn({props:a}),e.$on("mouseenter",i),e.$on("mouseleave",s),{c(){be(e.$$.fragment)},l(o){ve(e.$$.fragment,o)},m(o,r){ke(e,o,r),t=!0},p(o,r){l=o;const c=r&4?qt(n,[Kt(l[9])]):{};e.$set(c)},i(o){t||(N(e.$$.fragment,o),t=!0)},o(o){W(e.$$.fragment,o),t=!1},d(o){we(e,o)}}}function Vt(l){let e,t,n=l[2],i=[];for(let a=0;a<n.length;a+=1)i[a]=zt(Lt(l,n,a));const s=a=>W(i[a],1,1,()=>{i[a]=null});return{c(){for(let a=0;a<i.length;a+=1)i[a].c();e=Be()},l(a){for(let o=0;o<i.length;o+=1)i[o].l(a);e=Be()},m(a,o){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(a,o);T(a,e,o),t=!0},p(a,o){if(o&52){n=a[2];let r;for(r=0;r<n.length;r+=1){const c=Lt(a,n,r);i[r]?(i[r].p(c,o),N(i[r],1)):(i[r]=zt(c),i[r].c(),N(i[r],1),i[r].m(e.parentNode,e))}for(Ne(),r=n.length;r<i.length;r+=1)s(r);He()}},i(a){if(!t){for(let o=0;o<n.length;o+=1)N(i[o]);t=!0}},o(a){i=i.filter(Boolean);for(let o=0;o<i.length;o+=1)W(i[o]);t=!1},d(a){rt(i,a),a&&m(e)}}}function Vn(l){let e,t,n,i,s,a,o=l[2],r,c=l[3]&&Bt(l),u=Vt(l);return{c(){e=B("label"),t=ne(l[0]),n=Q(),i=B("table"),c&&c.c(),s=Q(),a=B("tbody"),u.c(),this.h()},l(d){e=$(d,"LABEL",{class:!0});var b=R(e);t=se(b,l[0]),b.forEach(m),n=Y(d),i=$(d,"TABLE",{class:!0});var C=R(i);c&&c.l(C),s=Y(C),a=$(C,"TBODY",{});var L=R(a);u.l(L),L.forEach(m),C.forEach(m),this.h()},h(){g(e,"class","w-1/3 pr-2 text-xs text-neutral-400 text-right"),g(i,"class","table-shadow w-full my-1 bg-neutral-700 border border-neutral-800 svelte-2meyxc")},m(d,b){T(d,e,b),M(e,t),T(d,n,b),T(d,i,b),c&&c.m(i,null),M(i,s),M(i,a),u.m(a,null),r=!0},p(d,[b]){(!r||b&1)&&Oe(t,d[0]),d[3]?c?c.p(d,b):(c=Bt(d),c.c(),c.m(i,s)):c&&(c.d(1),c=null),b&4&&_e(o,o=d[2])?(Ne(),W(u,1,1,q),He(),u=Vt(d),u.c(),N(u,1),u.m(a,null)):u.p(d,b)},i(d){r||(N(u),r=!0)},o(d){W(u),r=!1},d(d){d&&m(e),d&&m(n),d&&m(i),c&&c.d(),u.d(d)}}}function Nn(l,e,t){let{name:n}=e,{columns:i}=e,{rows:s}=e,{showColumns:a=!0}=e;const o=bt();function r(b){o("rowHover",b)}function c(b){o("rowLeave",b)}const u=b=>r(b),d=b=>c(b);return l.$$set=b=>{"name"in b&&t(0,n=b.name),"columns"in b&&t(1,i=b.columns),"rows"in b&&t(2,s=b.rows),"showColumns"in b&&t(3,a=b.showColumns)},[n,i,s,a,r,c,u,d]}class Hn extends Ee{constructor(e){super(),Pe(this,e,Nn,Vn,_e,{name:0,columns:1,rows:2,showColumns:3})}}function jn(l){let e,t,n,i,s,a;return{c(){e=B("label"),t=ne(l[0]),n=ne(":"),i=Q(),s=B("span"),a=ne(l[1]),this.h()},l(o){e=$(o,"LABEL",{class:!0});var r=R(e);t=se(r,l[0]),n=se(r,":"),r.forEach(m),i=Y(o),s=$(o,"SPAN",{class:!0});var c=R(s);a=se(c,l[1]),c.forEach(m),this.h()},h(){g(e,"class","text-xs text-neutral-400 text-right"),g(s,"class","text-xs text-neutral-200")},m(o,r){T(o,e,r),M(e,t),M(e,n),T(o,i,r),T(o,s,r),M(s,a)},p(o,[r]){r&1&&Oe(t,o[0]),r&2&&Oe(a,o[1])},i:q,o:q,d(o){o&&m(e),o&&m(i),o&&m(s)}}}function Un(l,e,t){let{name:n}=e,{label:i}=e;return l.$$set=s=>{"name"in s&&t(0,n=s.name),"label"in s&&t(1,i=s.label)},[n,i]}class ct extends Ee{constructor(e){super(),Pe(this,e,Un,jn,_e,{name:0,label:1})}}function Wn(l){let e,t,n,i,s,a,o,r;return{c(){e=B("div"),t=B("img"),i=Q(),s=B("canvas"),this.h()},l(c){e=$(c,"DIV",{class:!0});var u=R(e);t=$(u,"IMG",{src:!0,class:!0}),i=Y(u),s=$(u,"CANVAS",{class:!0}),R(s).forEach(m),u.forEach(m),this.h()},h(){ln(t.src,n=l[2])||g(t,"src",n),g(t,"class","absolute left-1/2 -translate-x-1/2 h-full object-contain"),g(s,"class","z-10 absolute left-1/2 -translate-x-1/2 h-full"),g(e,"class",a=(l[4].class??"")+" relative w-full h-full bg-white")},m(c,u){T(c,e,u),M(e,t),l[9](t),M(e,i),M(e,s),l[10](s),o||(r=Ie(t,"load",l[3]),o=!0)},p(c,u){u[0]&16&&a!==(a=(c[4].class??"")+" relative w-full h-full bg-white")&&g(e,"class",a)},i:q,o:q,d(c){c&&m(e),l[9](null),l[10](null),o=!1,r()}}}function Gn(l,e,t){const n={},i={};let s=0,a=0,o=0,r=0;l.forEach((C,L)=>{var F,j;n[F=C.valence]||(n[F]=0),n[C.valence]+=e[L],i[j=C.intensity]||(i[j]=0),i[C.intensity]+=e[L]}),Object.keys(n).map(C=>{let L=(t-n[C])/t;L===0&&(L=1),o+=L*parseInt(C),s+=L}),Object.keys(i).map(C=>{let L=(t-i[C])/t;L===0&&(L=1),r+=L*parseInt(C),a+=L});const c=s?o/s:0,u=a?r/a:0,d=Math.round(c*100)/100,b=Math.round(u*100)/100;return{avgValence:d,avgIntensity:b}}function qn(l,e,t){const n=l.getImageData(0,0,e,t).data;let i=0;for(let s=3,a=n.length;s<a;s+=4)n[s]>0&&++i;return i}function Kn(l,e,t){let{persona:n}=e,{participantsDrawings:i}=e;function s(){return f}function a(){const y=`Participant-${F+1}-${n}`,z=r.toDataURL("image/png");return{name:y,data:z}}let o,r,c,u=0,d=0,b=1,C=vt[n],L,F=on(lt.selectedParticipantIdx)??0,j=i[F],K={name:"Strokes",columns:[],rows:[]},U=[],ce=0,Z=0,he=0,v={},S={onFieldMount:h,fields:[{id:"participant",component:xn,props:{name:"Participant",options:i.map((k,y)=>`Participant #${y+1}`),selected:F,onChange:_}},{id:"strokes",component:Hn,props:K},{id:"totalDrawnArea",component:ct,props:{name:"Drawing size",label:`${ce} pixels`}},{id:"avgValence",component:ct,props:{name:"Avg valence",label:Z}},{id:"avgIntensity",component:ct,props:{name:"Avg intensity",label:he}}]},f=[{isConfig:!0,tabs:[{title:"Settings",defaultActive:!0,component:kt,props:S}]}];function h(k,y){if(v[k]=y,k==="strokes"){const z=H(j);v.strokes.$set(z),v.strokes.$on("rowHover",A),v.strokes.$on("rowLeave",X)}v.totalDrawnArea&&v.totalDrawnArea.$set({label:`${ce} pixels`}),v.avgValence&&v.avgValence.$set({label:Z}),v.avgIntensity&&v.avgIntensity.$set({label:he})}function p(){const k=r.getContext("2d");if(k==null){nt(`Error: Could not get context of canvas for ${n}.`);return}c=k}function w(){L.classList.remove("hidden");const k=L.getBoundingClientRect();E(k.width,k.height),x(k.width,k.height),u=k.width,d=k.height,b=k.width/L.width,P(j)}function E(k,y){const z=window.devicePixelRatio||1;t(0,r.width=k*z,r),t(0,r.height=y*z,r),c.scale(z,z)}function x(k,y){L.classList.remove("hidden"),c.drawImage(L,0,0,k,y),c.globalCompositeOperation="source-atop",L.classList.add("hidden")}function H(k){const y={name:"Strokes",columns:["Valence","Intensity","Color","Size"],rows:[]};return k.forEach((z,ie)=>{y.rows.push({cells:[{value:z.valence},{value:z.intensity},{value:z.brushColor,formatter:ee=>`<span class="block w-full h-3" style="background-color: ${ee};"></span>`},{value:ie<U.length?U[ie]:""}]})}),y}function le(k){const y=[];let z=0;for(let ie of k){const ee=G(ie);y.push(ee),z+=ee}return{totalArea:z,areas:y}}function P(k){Xe(k,c,b);const y=le(k),z=Gn(k,y.areas,y.totalArea);ce=y.totalArea,U=y.areas,Z=z.avgValence,he=z.avgIntensity,j=k,K=H(k),v.strokes&&v.strokes.$set(K),v.totalDrawnArea&&v.totalDrawnArea.$set({label:`${ce} pixels`}),v.avgValence&&v.avgValence.$set({label:Z}),v.avgIntensity&&v.avgIntensity.$set({label:he})}function _(k){const y=parseInt(k),z=i[y];x(u,d),P(z),lt.selectedParticipantIdx.set(y),F=y}function V(){r.getBoundingClientRect()}function A({detail:k}){const y=[j[k]];x(u,d),Xe(y,c,b)}function X(){x(u,d),Xe(j,c,b)}function G(k){const y=document.createElement("canvas"),z=y.getContext("2d");if(z==null)throw"Error: Could not get canvas context while getting drawn pixels.";return y.width=u,y.height=d,Xe([k],z,b),qn(z,u,d)}st(()=>{if(C==null){nt(`Error: Persona SVG path of ${n} was not found.`);return}p(),o=new ResizeObserver(V),o.observe(r)}),it(()=>{r&&o.unobserve(r)});function I(k){ye[k?"unshift":"push"](()=>{L=k,t(1,L)})}function D(k){ye[k?"unshift":"push"](()=>{r=k,t(0,r)})}return l.$$set=k=>{t(4,e=Ke(Ke({},e),tt(k))),"persona"in k&&t(5,n=k.persona),"participantsDrawings"in k&&t(6,i=k.participantsDrawings)},e=tt(e),[r,L,C,w,e,n,i,s,a,I,D]}class Jn extends Ee{constructor(e){super(),Pe(this,e,Kn,Wn,_e,{persona:5,participantsDrawings:6,getConfigPanelsProps:7,getImage:8},null,[-1,-1])}get persona(){return this.$$.ctx[5]}set persona(e){this.$$set({persona:e}),qe()}get participantsDrawings(){return this.$$.ctx[6]}set participantsDrawings(e){this.$$set({participantsDrawings:e}),qe()}get getConfigPanelsProps(){return this.$$.ctx[7]}get getImage(){return this.$$.ctx[8]}}class Zt{constructor(e,t,n,i,s){Ze(this,"xDomain");Ze(this,"yDomain");Ze(this,"binWidth",1);Ze(this,"binHeight",1);Ze(this,"_bins",{});this.xDomain=t,this.yDomain=n,this.binWidth=i??this.binWidth,this.binHeight=s??this.binHeight,this.makeBins(),this.binPoints(e)}makeBins(){for(let e=this.xDomain[0],t=this.xDomain[1];e<t;e+=this.binWidth)for(let n=this.yDomain[0],i=this.yDomain[1];n<i;n+=this.binHeight){const s=Math.floor(e/this.binWidth),a=Math.floor(n/this.binHeight),o=s+"-"+a,r=s*this.binWidth,c=a*this.binHeight;this._bins[o]=Object.assign(new Array,{nx:s,ny:a,x:r,y:c})}}binPoints(e){for(let t of e){const n=Math.floor(t.x/this.binWidth),i=Math.floor(t.y/this.binHeight),s=n+"-"+i,a=this._bins[s];if(a===void 0)throw`Error: Could not find bin for point ${t}`;a.push(t)}}get bins(){return Object.values(this._bins).filter(e=>e.length>0)}}function Qn(l){let e,t,n,i,s,a,o,r;return{c(){e=B("div"),t=B("label"),n=ne(l[1]),i=ne(":"),s=Q(),a=B("input"),this.h()},l(c){e=$(c,"DIV",{class:!0});var u=R(e);t=$(u,"LABEL",{class:!0});var d=R(t);n=se(d,l[1]),i=se(d,":"),d.forEach(m),s=Y(u),a=$(u,"INPUT",{type:!0,name:!0,id:!0,class:!0}),u.forEach(m),this.h()},h(){g(t,"class","pr-2 text-xs text-neutral-400 text-right"),g(a,"type","color"),g(a,"name",l[1]),g(a,"id",l[1]),g(a,"class","emboss py-1 px-2 bg-neutral-700 border border-neutral-800 text-xs text-neutral-200"),g(e,"class","flex items-center")},m(c,u){T(c,e,u),M(e,t),M(t,n),M(t,i),M(e,s),M(e,a),yt(a,l[0]),o||(r=[Ie(a,"input",l[2]),Ie(a,"input",l[4])],o=!0)},p(c,[u]){u&2&&Oe(n,c[1]),u&2&&g(a,"name",c[1]),u&2&&g(a,"id",c[1]),u&1&&yt(a,c[0])},i:q,o:q,d(c){c&&m(e),o=!1,dt(r)}}}function Yn(l,e,t){let{name:n}=e,{value:i="#0000FF"}=e,{onChange:s}=e;function a(r){if(r.target){const c=r.target;s(c.value)}}function o(){i=this.value,t(0,i)}return l.$$set=r=>{"name"in r&&t(1,n=r.name),"value"in r&&t(0,i=r.value),"onChange"in r&&t(3,s=r.onChange)},[i,n,a,s,o]}class Xt extends Ee{constructor(e){super(),Pe(this,e,Yn,Qn,_e,{name:1,value:0,onChange:3})}}function Nt(l){let e,t,n,i,s;return{c(){e=B("span"),t=De("svg"),n=De("circle"),i=De("path"),s=ne(`
      Processing...`),this.h()},l(a){e=$(a,"SPAN",{class:!0,disabled:!0});var o=R(e);t=Se(o,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var r=R(t);n=Se(r,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),R(n).forEach(m),i=Se(r,"path",{class:!0,fill:!0,d:!0}),R(i).forEach(m),r.forEach(m),s=se(o,`
      Processing...`),o.forEach(m),this.h()},h(){g(n,"class","opacity-25"),g(n,"cx","12"),g(n,"cy","12"),g(n,"r","10"),g(n,"stroke","currentColor"),g(n,"stroke-width","4"),g(i,"class","opacity-75"),g(i,"fill","currentColor"),g(i,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),g(t,"class","animate-spin -ml-1 mr-3 h-5 w-5 text-neutral-500"),g(t,"xmlns","http://www.w3.org/2000/svg"),g(t,"fill","none"),g(t,"viewBox","0 0 24 24"),g(e,"class","z-20 absolute top-0 left-0 flex items-center justify-center w-full h-full bg-white font-semibold text-sm text-neutral-600"),g(e,"disabled","")},m(a,o){T(a,e,o),M(e,t),M(t,n),M(t,i),M(e,s)},d(a){a&&m(e)}}}function Zn(l){let e,t,n,i,s,a,o=l[2]&&Nt();return{c(){e=B("div"),o&&o.c(),t=Q(),n=B("img"),i=Q(),s=B("canvas"),this.h()},l(r){e=$(r,"DIV",{class:!0});var c=R(e);o&&o.l(c),t=Y(c),n=$(c,"IMG",{class:!0}),i=Y(c),s=$(c,"CANVAS",{class:!0}),R(s).forEach(m),c.forEach(m),this.h()},h(){g(n,"class","absolute left-1/2 -translate-x-1/2 h-full object-contain"),g(s,"class","z-10 absolute left-1/2 -translate-x-1/2 h-full"),g(e,"class",a=(l[3].class??"")+" relative w-full h-full bg-white")},m(r,c){T(r,e,c),o&&o.m(e,null),M(e,t),M(e,n),l[9](n),M(e,i),M(e,s),l[10](s)},p(r,[c]){r[2]?o||(o=Nt(),o.c(),o.m(e,t)):o&&(o.d(1),o=null),c&8&&a!==(a=(r[3].class??"")+" relative w-full h-full bg-white")&&g(e,"class",a)},i:q,o:q,d(r){r&&m(e),o&&o.d(),l[9](null),l[10](null)}}}function Xn(l,e,t){const n=[],i=l.getImageData(0,0,e,t).data;for(let s=3,a=i.length;s<a;s+=4)if(i[s]>0){const o=Math.floor(s/4)%e,r=Math.floor(s/4/e);n.push({x:o,y:r})}return n}function es(l,e,t){let{persona:n}=e,{participantsStrokes:i}=e,{totalParticipants:s}=e;function a(){return v}function o(){const _=`DensityMap-${n}`,V=c.toDataURL("image/png");return{name:_,data:V}}let r,c,u,d=0,b=0,C=1,L=vt[n],F,j,K,U,ce=!0;et.mapColors[n].subscribe(_=>{j=Ge(_).hex(),K=Ge.scale([Ge("#b5b5b5"),Ge(_)])});let Z={},v=[{isConfig:!0,tabs:[{title:"Settings",defaultActive:!0,component:kt,props:{onFieldMount:S,fields:[{id:"mapColor",component:Xt,props:{name:"Map color",onChange:H}}]}}]}];function S(_,V){Z[_]=V,_==="mapColor"&&Z.mapColor.$set({value:j})}function f(){const _=c.getContext("2d");if(_==null){nt(`Error: Could not get context of canvas for ${n}.`);return}u=_}function h(){if(F==null)return;const _=F.getBoundingClientRect();Jt(_.width,_.height,c,u),p(_.width,_.height),d=Math.floor(_.width),b=Math.floor(_.height),C=_.width/F.width;const V=E(i),A=new Zt(V,[0,d],[0,b]);w(A,s),U=A,t(2,ce=!1)}function p(_,V){F.classList.remove("hidden"),Qt(F,u,_,V,!0),F.classList.add("hidden")}function w(_,V){const A=_.bins,X=K.domain([0,V]);for(let G of A)u.fillStyle=X(G.length).hex(),u.fillRect(G.x,G.y,_.binWidth,_.binHeight)}function E(_){let V=[];for(let A of _){const X=document.createElement("canvas"),G=X.getContext("2d");if(G==null)throw"Error: Could not get canvas context while getting drawn pixels.";X.width=d,X.height=b,Xe(A,G,C);const I=Xn(G,d,b);V=V.concat(I)}return V}function x(){c.getBoundingClientRect()}function H(_){j=_,et.mapColors[n].set(_),t(2,ce=!0),w(U,s),t(2,ce=!1)}st(()=>{if(L==null){nt(`Error: Persona SVG path of ${n} was not found.`);return}f(),t(1,F.onload=h,F),t(1,F.src=L,F),r=new ResizeObserver(x),r.observe(c)}),it(()=>{c&&r.unobserve(c)});function le(_){ye[_?"unshift":"push"](()=>{F=_,t(1,F)})}function P(_){ye[_?"unshift":"push"](()=>{c=_,t(0,c)})}return l.$$set=_=>{t(3,e=Ke(Ke({},e),tt(_))),"persona"in _&&t(4,n=_.persona),"participantsStrokes"in _&&t(5,i=_.participantsStrokes),"totalParticipants"in _&&t(6,s=_.totalParticipants)},e=tt(e),[c,F,ce,e,n,i,s,a,o,le,P]}class ts extends Ee{constructor(e){super(),Pe(this,e,es,Zn,_e,{persona:4,participantsStrokes:5,totalParticipants:6,getConfigPanelsProps:7,getImage:8})}get persona(){return this.$$.ctx[4]}set persona(e){this.$$set({persona:e}),qe()}get participantsStrokes(){return this.$$.ctx[5]}set participantsStrokes(e){this.$$set({participantsStrokes:e}),qe()}get totalParticipants(){return this.$$.ctx[6]}set totalParticipants(e){this.$$set({totalParticipants:e}),qe()}get getConfigPanelsProps(){return this.$$.ctx[7]}get getImage(){return this.$$.ctx[8]}}function Ht(l){let e,t,n,i,s;return{c(){e=B("span"),t=De("svg"),n=De("circle"),i=De("path"),s=ne(`
      Processing...`),this.h()},l(a){e=$(a,"SPAN",{class:!0,disabled:!0});var o=R(e);t=Se(o,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var r=R(t);n=Se(r,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),R(n).forEach(m),i=Se(r,"path",{class:!0,fill:!0,d:!0}),R(i).forEach(m),r.forEach(m),s=se(o,`
      Processing...`),o.forEach(m),this.h()},h(){g(n,"class","opacity-25"),g(n,"cx","12"),g(n,"cy","12"),g(n,"r","10"),g(n,"stroke","currentColor"),g(n,"stroke-width","4"),g(i,"class","opacity-75"),g(i,"fill","currentColor"),g(i,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),g(t,"class","animate-spin -ml-1 mr-3 h-5 w-5 text-neutral-500"),g(t,"xmlns","http://www.w3.org/2000/svg"),g(t,"fill","none"),g(t,"viewBox","0 0 24 24"),g(e,"class","z-20 absolute top-0 left-0 flex items-center justify-center w-full h-full bg-white font-semibold text-sm text-neutral-600"),g(e,"disabled","")},m(a,o){T(a,e,o),M(e,t),M(t,n),M(t,i),M(e,s)},d(a){a&&m(e)}}}function ns(l){let e,t,n,i,s,a,o=l[2]&&Ht();return{c(){e=B("div"),o&&o.c(),t=Q(),n=B("img"),i=Q(),s=B("canvas"),this.h()},l(r){e=$(r,"DIV",{class:!0});var c=R(e);o&&o.l(c),t=Y(c),n=$(c,"IMG",{class:!0}),i=Y(c),s=$(c,"CANVAS",{class:!0}),R(s).forEach(m),c.forEach(m),this.h()},h(){g(n,"class","absolute left-1/2 -translate-x-1/2 h-full object-contain"),g(s,"class","z-10 absolute left-1/2 -translate-x-1/2 h-full"),g(e,"class",a=(l[3].class??"")+" relative w-full h-full bg-white")},m(r,c){T(r,e,c),o&&o.m(e,null),M(e,t),M(e,n),l[9](n),M(e,i),M(e,s),l[10](s)},p(r,[c]){r[2]?o||(o=Ht(),o.c(),o.m(e,t)):o&&(o.d(1),o=null),c&8&&a!==(a=(r[3].class??"")+" relative w-full h-full bg-white")&&g(e,"class",a)},i:q,o:q,d(r){r&&m(e),o&&o.d(),l[9](null),l[10](null)}}}function ss(l,e,t,n){const i=[],s=l.getImageData(0,0,e,t).data;for(let a=3,o=s.length;a<o;a+=4)if(s[a]>0){const r=Math.floor(a/4)%e,c=Math.floor(a/4/e);i.push({x:r,y:c,measure:n})}return i}function is(l,e,t){let{persona:n}=e,{participantsStrokes:i}=e,{totalParticipants:s}=e;function a(){return he}function o(){const P=`ValenceMap-${n}`,_=c.toDataURL("image/png");return{name:P,data:_}}let r,c,u,d=0,b=0,C=1,L=vt[n],F,j,K,U=!0;dn.mapColors[n].subscribe(P=>{j=Ge(P).hex(),K=Ge.scale([Ge("red"),Ge("green")])});let ce={},he=[{isConfig:!0,tabs:[{title:"Settings",defaultActive:!0,component:kt,props:{onFieldMount:v,fields:[{id:"mapColor",component:Xt,props:{name:"Map color",onChange:x}}]}}]}];function v(P,_){ce[P]=_,P==="mapColor"&&ce.mapColor.$set({value:j})}function S(){const P=c.getContext("2d");if(P==null){nt(`Error: Could not get context of canvas for ${n}.`);return}u=P}function f(){if(F==null)return;const P=F.getBoundingClientRect();Jt(P.width,P.height,c,u),h(P.width,P.height),d=Math.floor(P.width),b=Math.floor(P.height),C=P.width/F.width;const _=w(i),V=new Zt(_,[0,d],[0,b]);p(V),t(2,U=!1)}function h(P,_){F.classList.remove("hidden"),Qt(F,u,P,_,!0),F.classList.add("hidden")}function p(P){const _=P.bins,V=K.domain([-50,50]);for(let A of _){const G=A.map(I=>I.measure).reduce((I,D)=>I+D,0)/A.length;u.fillStyle=V(G).hex(),u.fillRect(A.x,A.y,P.binWidth,P.binHeight)}}function w(P){let _=[];for(let V of P){const A=document.createElement("canvas"),X=A.getContext("2d");if(X==null)throw"Error: Could not get canvas context while getting drawn pixels.";A.width=d,A.height=b;for(let G of V){const I=G.intensity*G.valence;Xe([G],X,C);const D=ss(X,d,b,I);_=_.concat(D),X.clearRect(0,0,d,b)}}return _}function E(){c.getBoundingClientRect()}function x(P){j=P,DensityMapStore.mapColors[n].set(P),t(2,U=!0),drawDensityMap(bins,s),t(2,U=!1)}st(()=>{if(L==null){nt(`Error: Persona SVG path of ${n} was not found.`);return}S(),t(1,F.onload=f,F),t(1,F.src=L,F),r=new ResizeObserver(E),r.observe(c)}),it(()=>{c&&r.unobserve(c)});function H(P){ye[P?"unshift":"push"](()=>{F=P,t(1,F)})}function le(P){ye[P?"unshift":"push"](()=>{c=P,t(0,c)})}return l.$$set=P=>{t(3,e=Ke(Ke({},e),tt(P))),"persona"in P&&t(4,n=P.persona),"participantsStrokes"in P&&t(5,i=P.participantsStrokes),"totalParticipants"in P&&t(6,s=P.totalParticipants)},e=tt(e),[c,F,U,e,n,i,s,a,o,H,le]}class rs extends Ee{constructor(e){super(),Pe(this,e,is,ns,_e,{persona:4,participantsStrokes:5,totalParticipants:6,getConfigPanelsProps:7,getImage:8})}get persona(){return this.$$.ctx[4]}set persona(e){this.$$set({persona:e}),qe()}get participantsStrokes(){return this.$$.ctx[5]}set participantsStrokes(e){this.$$set({participantsStrokes:e}),qe()}get totalParticipants(){return this.$$.ctx[6]}set totalParticipants(e){this.$$set({totalParticipants:e}),qe()}get getConfigPanelsProps(){return this.$$.ctx[7]}get getImage(){return this.$$.ctx[8]}}function as(l){let e;return{c(){e=ne("Load Survey Data")},l(t){e=se(t,"Load Survey Data")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function jt(l){let e,t,n,i,s,a,o,r;return e=new Le({props:{$$slots:{default:[ls]},$$scope:{ctx:l}}}),e.$on("click",l[12]),n=new Le({props:{$$slots:{default:[os]},$$scope:{ctx:l}}}),n.$on("click",l[13]),s=new wn({}),o=new Le({props:{$$slots:{default:[cs]},$$scope:{ctx:l}}}),o.$on("click",l[8]),{c(){be(e.$$.fragment),t=Q(),be(n.$$.fragment),i=Q(),be(s.$$.fragment),a=Q(),be(o.$$.fragment)},l(c){ve(e.$$.fragment,c),t=Y(c),ve(n.$$.fragment,c),i=Y(c),ve(s.$$.fragment,c),a=Y(c),ve(o.$$.fragment,c)},m(c,u){ke(e,c,u),T(c,t,u),ke(n,c,u),T(c,i,u),ke(s,c,u),T(c,a,u),ke(o,c,u),r=!0},p(c,u){const d={};u[1]&64&&(d.$$scope={dirty:u,ctx:c}),e.$set(d);const b={};u[1]&64&&(b.$$scope={dirty:u,ctx:c}),n.$set(b);const C={};u[1]&64&&(C.$$scope={dirty:u,ctx:c}),o.$set(C)},i(c){r||(N(e.$$.fragment,c),N(n.$$.fragment,c),N(s.$$.fragment,c),N(o.$$.fragment,c),r=!0)},o(c){W(e.$$.fragment,c),W(n.$$.fragment,c),W(s.$$.fragment,c),W(o.$$.fragment,c),r=!1},d(c){we(e,c),c&&m(t),we(n,c),c&&m(i),we(s,c),c&&m(a),we(o,c)}}}function ls(l){let e;return{c(){e=ne("Export image")},l(t){e=se(t,"Export image")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function os(l){let e;return{c(){e=ne("Export data (CSV)")},l(t){e=se(t,"Export data (CSV)")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function cs(l){let e;return{c(){e=ne("Close project")},l(t){e=se(t,"Close project")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function us(l){let e,t,n,i;e=new Le({props:{$$slots:{default:[as]},$$scope:{ctx:l}}}),e.$on("click",l[7]);let s=l[3]&&jt(l);return{c(){be(e.$$.fragment),t=Q(),s&&s.c(),n=Be()},l(a){ve(e.$$.fragment,a),t=Y(a),s&&s.l(a),n=Be()},m(a,o){ke(e,a,o),T(a,t,o),s&&s.m(a,o),T(a,n,o),i=!0},p(a,o){const r={};o[1]&64&&(r.$$scope={dirty:o,ctx:a}),e.$set(r),a[3]?s?(s.p(a,o),o[0]&8&&N(s,1)):(s=jt(a),s.c(),N(s,1),s.m(n.parentNode,n)):s&&(Ne(),W(s,1,1,()=>{s=null}),He())},i(a){i||(N(e.$$.fragment,a),N(s),i=!0)},o(a){W(e.$$.fragment,a),W(s),i=!1},d(a){we(e,a),a&&m(t),s&&s.d(a),a&&m(n)}}}function Ut(l){let e,t,n,i,s={title:"View",$$slots:{default:[ps]},$$scope:{ctx:l}};e=new ht({props:s}),l[18](e);let a={title:"Tools",enableIcon:!0,$$slots:{default:[ws]},$$scope:{ctx:l}};return n=new ht({props:a}),l[22](n),{c(){be(e.$$.fragment),t=Q(),be(n.$$.fragment)},l(o){ve(e.$$.fragment,o),t=Y(o),ve(n.$$.fragment,o)},m(o,r){ke(e,o,r),T(o,t,r),ke(n,o,r),i=!0},p(o,r){const c={};r[0]&2|r[1]&64&&(c.$$scope={dirty:r,ctx:o}),e.$set(c);const u={};r[0]&2|r[1]&64&&(u.$$scope={dirty:r,ctx:o}),n.$set(u)},i(o){i||(N(e.$$.fragment,o),N(n.$$.fragment,o),i=!0)},o(o){W(e.$$.fragment,o),W(n.$$.fragment,o),i=!1},d(o){l[18](null),we(e,o),o&&m(t),l[22](null),we(n,o)}}}function fs(l){let e;return{c(){e=ne("Single")},l(t){e=se(t,"Single")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function hs(l){let e;return{c(){e=ne("Side by side")},l(t){e=se(t,"Side by side")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function Wt(l){let e,t;return e=new Le({props:{$$slots:{default:[ds]},$$scope:{ctx:l}}}),e.$on("click",l[17]),{c(){be(e.$$.fragment)},l(n){ve(e.$$.fragment,n)},m(n,i){ke(e,n,i),t=!0},p(n,i){const s={};i[1]&64&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){t||(N(e.$$.fragment,n),t=!0)},o(n){W(e.$$.fragment,n),t=!1},d(n){we(e,n)}}}function ds(l){let e;return{c(){e=ne("Grid")},l(t){e=se(t,"Grid")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function ps(l){let e,t,n,i,s,a;e=new Le({props:{$$slots:{default:[fs]},$$scope:{ctx:l}}}),e.$on("click",l[15]),n=new Le({props:{$$slots:{default:[hs]},$$scope:{ctx:l}}}),n.$on("click",l[16]);let o=l[1]!==me.LookingGlass&&Wt(l);return{c(){be(e.$$.fragment),t=Q(),be(n.$$.fragment),i=Q(),o&&o.c(),s=Be()},l(r){ve(e.$$.fragment,r),t=Y(r),ve(n.$$.fragment,r),i=Y(r),o&&o.l(r),s=Be()},m(r,c){ke(e,r,c),T(r,t,c),ke(n,r,c),T(r,i,c),o&&o.m(r,c),T(r,s,c),a=!0},p(r,c){const u={};c[1]&64&&(u.$$scope={dirty:c,ctx:r}),e.$set(u);const d={};c[1]&64&&(d.$$scope={dirty:c,ctx:r}),n.$set(d),r[1]!==me.LookingGlass?o?(o.p(r,c),c[0]&2&&N(o,1)):(o=Wt(r),o.c(),N(o,1),o.m(s.parentNode,s)):o&&(Ne(),W(o,1,1,()=>{o=null}),He())},i(r){a||(N(e.$$.fragment,r),N(n.$$.fragment,r),N(o),a=!0)},o(r){W(e.$$.fragment,r),W(n.$$.fragment,r),W(o),a=!1},d(r){we(e,r),r&&m(t),we(n,r),r&&m(i),o&&o.d(r),r&&m(s)}}}function gs(l){let e=me.LookingGlass+"",t;return{c(){t=ne(e)},l(n){t=se(n,e)},m(n,i){T(n,t,i)},p:q,d(n){n&&m(t)}}}function ms(l){let e,t,n;return{c(){e=De("svg"),t=De("path"),n=De("path"),this.h()},l(i){e=Se(i,"svg",{slot:!0,xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,stroke:!0,fill:!0,"stroke-linecap":!0,"stroke-linejoin":!0});var s=R(e);t=Se(s,"path",{stroke:!0,d:!0,fill:!0}),R(t).forEach(m),n=Se(s,"path",{d:!0}),R(n).forEach(m),s.forEach(m),this.h()},h(){g(t,"stroke","none"),g(t,"d","M0 0h24v24H0z"),g(t,"fill","none"),g(n,"d","M5 12l5 5l10 -10"),g(e,"slot","icon"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"width","14"),g(e,"height","14"),g(e,"viewBox","0 0 24 24"),g(e,"stroke-width","2"),g(e,"stroke","currentColor"),g(e,"fill","none"),g(e,"stroke-linecap","round"),g(e,"stroke-linejoin","round"),ae(e,"hidden",!l[36])},m(i,s){T(i,e,s),M(e,t),M(e,n)},p(i,s){s[1]&32&&ae(e,"hidden",!i[36])},d(i){i&&m(e)}}}function _s(l){let e=me.DensityMap+"",t;return{c(){t=ne(e)},l(n){t=se(n,e)},m(n,i){T(n,t,i)},p:q,d(n){n&&m(t)}}}function bs(l){let e,t,n;return{c(){e=De("svg"),t=De("path"),n=De("path"),this.h()},l(i){e=Se(i,"svg",{slot:!0,xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,stroke:!0,fill:!0,"stroke-linecap":!0,"stroke-linejoin":!0});var s=R(e);t=Se(s,"path",{stroke:!0,d:!0,fill:!0}),R(t).forEach(m),n=Se(s,"path",{d:!0}),R(n).forEach(m),s.forEach(m),this.h()},h(){g(t,"stroke","none"),g(t,"d","M0 0h24v24H0z"),g(t,"fill","none"),g(n,"d","M5 12l5 5l10 -10"),g(e,"slot","icon"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"width","16"),g(e,"height","16"),g(e,"viewBox","0 0 24 24"),g(e,"stroke-width","2"),g(e,"stroke","currentColor"),g(e,"fill","none"),g(e,"stroke-linecap","round"),g(e,"stroke-linejoin","round"),ae(e,"hidden",!l[36])},m(i,s){T(i,e,s),M(e,t),M(e,n)},p(i,s){s[1]&32&&ae(e,"hidden",!i[36])},d(i){i&&m(e)}}}function vs(l){let e=me.ValenceMap+"",t;return{c(){t=ne(e)},l(n){t=se(n,e)},m(n,i){T(n,t,i)},p:q,d(n){n&&m(t)}}}function ks(l){let e,t,n;return{c(){e=De("svg"),t=De("path"),n=De("path"),this.h()},l(i){e=Se(i,"svg",{slot:!0,xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,stroke:!0,fill:!0,"stroke-linecap":!0,"stroke-linejoin":!0});var s=R(e);t=Se(s,"path",{stroke:!0,d:!0,fill:!0}),R(t).forEach(m),n=Se(s,"path",{d:!0}),R(n).forEach(m),s.forEach(m),this.h()},h(){g(t,"stroke","none"),g(t,"d","M0 0h24v24H0z"),g(t,"fill","none"),g(n,"d","M5 12l5 5l10 -10"),g(e,"slot","icon"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"width","16"),g(e,"height","16"),g(e,"viewBox","0 0 24 24"),g(e,"stroke-width","2"),g(e,"stroke","currentColor"),g(e,"fill","none"),g(e,"stroke-linecap","round"),g(e,"stroke-linejoin","round"),ae(e,"hidden",!l[36])},m(i,s){T(i,e,s),M(e,t),M(e,n)},p(i,s){s[1]&32&&ae(e,"hidden",!i[36])},d(i){i&&m(e)}}}function ws(l){let e,t,n,i,s,a;return e=new Le({props:{isActive:l[1]===me.LookingGlass,$$slots:{icon:[ms,({isActive:o})=>({36:o}),({isActive:o})=>[0,o?32:0]],default:[gs]},$$scope:{ctx:l}}}),e.$on("click",l[19]),n=new Le({props:{isActive:l[1]===me.DensityMap,$$slots:{icon:[bs,({isActive:o})=>({36:o}),({isActive:o})=>[0,o?32:0]],default:[_s]},$$scope:{ctx:l}}}),n.$on("click",l[20]),s=new Le({props:{isActive:l[1]===me.ValenceMap,$$slots:{icon:[ks,({isActive:o})=>({36:o}),({isActive:o})=>[0,o?32:0]],default:[vs]},$$scope:{ctx:l}}}),s.$on("click",l[21]),{c(){be(e.$$.fragment),t=Q(),be(n.$$.fragment),i=Q(),be(s.$$.fragment)},l(o){ve(e.$$.fragment,o),t=Y(o),ve(n.$$.fragment,o),i=Y(o),ve(s.$$.fragment,o)},m(o,r){ke(e,o,r),T(o,t,r),ke(n,o,r),T(o,i,r),ke(s,o,r),a=!0},p(o,r){const c={};r[0]&2&&(c.isActive=o[1]===me.LookingGlass),r[1]&96&&(c.$$scope={dirty:r,ctx:o}),e.$set(c);const u={};r[0]&2&&(u.isActive=o[1]===me.DensityMap),r[1]&96&&(u.$$scope={dirty:r,ctx:o}),n.$set(u);const d={};r[0]&2&&(d.isActive=o[1]===me.ValenceMap),r[1]&96&&(d.$$scope={dirty:r,ctx:o}),s.$set(d)},i(o){a||(N(e.$$.fragment,o),N(n.$$.fragment,o),N(s.$$.fragment,o),a=!0)},o(o){W(e.$$.fragment,o),W(n.$$.fragment,o),W(s.$$.fragment,o),a=!1},d(o){we(e,o),o&&m(t),we(n,o),o&&m(i),we(s,o)}}}function Cs(l){let e,t,n,i,s;return{c(){e=B("div"),t=B("button"),n=ne("Load Survey Data"),this.h()},l(a){e=$(a,"DIV",{class:!0});var o=R(e);t=$(o,"BUTTON",{class:!0});var r=R(t);n=se(r,"Load Survey Data"),r.forEach(m),o.forEach(m),this.h()},h(){g(t,"class","py-1 px-2 bg-neutral-600 hover:bg-neutral-700 border border-neutral-900 shadow text-neutral-100 text-xs"),g(e,"class","row-start-2 row-end-4 flex items-center justify-center bg-neutral-800")},m(a,o){T(a,e,o),M(e,t),M(t,n),i||(s=Ie(t,"click",l[7]),i=!0)},p:q,i:q,o:q,d(a){a&&m(e),i=!1,s()}}}function ys(l){let e=l[6],t,n,i=Gt(l);return{c(){i.c(),t=Be()},l(s){i.l(s),t=Be()},m(s,a){i.m(s,a),T(s,t,a),n=!0},p(s,a){a[0]&64&&_e(e,e=s[6])?(Ne(),W(i,1,1,q),He(),i=Gt(s),i.c(),N(i,1),i.m(t.parentNode,t)):i.p(s,a)},i(s){n||(N(i),n=!0)},o(s){W(i),n=!1},d(s){s&&m(t),i.d(s)}}}function Gt(l){let e,t,n={defaultPanelProps:l[6]};return e=new In({props:n}),l[23](e),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){ke(e,i,s),t=!0},p(i,s){const a={};s[0]&64&&(a.defaultPanelProps=i[6]),e.$set(a)},i(i){t||(N(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){l[23](null),we(e,i)}}}function Es(l){let e,t,n,i,s,a,o,r,c,u,d,b,C,L,F,j,K;n=new ht({props:{title:"Project",$$slots:{default:[us]},$$scope:{ctx:l}}});let U=l[3]&&Ut(l);const ce=[ys,Cs],Z=[];function he(v,S){return v[3]&&v[6]?0:1}return d=he(l),b=Z[d]=ce[d](l),{c(){e=B("section"),t=B("header"),be(n.$$.fragment),i=Q(),U&&U.c(),s=Q(),a=B("span"),o=Q(),r=B("h1"),c=ne("InteroMap"),u=Q(),b.c(),C=Q(),L=B("input"),this.h()},l(v){e=$(v,"SECTION",{class:!0});var S=R(e);t=$(S,"HEADER",{class:!0});var f=R(t);ve(n.$$.fragment,f),i=Y(f),U&&U.l(f),s=Y(f),a=$(f,"SPAN",{class:!0}),R(a).forEach(m),o=Y(f),r=$(f,"H1",{class:!0,style:!0});var h=R(r);c=se(h,"InteroMap"),h.forEach(m),f.forEach(m),u=Y(S),b.l(S),S.forEach(m),C=Y(v),L=$(v,"INPUT",{type:!0,class:!0,accept:!0}),this.h()},h(){g(a,"class","flex-grow"),g(r,"class","flex items-center h-full px-2 bg-gradient-to-t from-orange-600 to-orange-500 text-neutral-100 font-bold text-xs lowercase tracking-wider"),ft(r,"font-variant","small-caps"),g(t,"class","emboss z-20 flex items-center bg-neutral-600 border-b border-neutral-800"),g(e,"class","app-layout w-screen h-screen svelte-14urve1"),g(L,"type","file"),g(L,"class","hidden"),g(L,"accept",".csv")},m(v,S){T(v,e,S),M(e,t),ke(n,t,null),M(t,i),U&&U.m(t,null),M(t,s),M(t,a),M(t,o),M(t,r),M(r,c),M(e,u),Z[d].m(e,null),T(v,C,S),T(v,L,S),l[24](L),F=!0,j||(K=Ie(L,"change",l[10]),j=!0)},p(v,S){const f={};S[0]&8|S[1]&64&&(f.$$scope={dirty:S,ctx:v}),n.$set(f),v[3]?U?(U.p(v,S),S[0]&8&&N(U,1)):(U=Ut(v),U.c(),N(U,1),U.m(t,s)):U&&(Ne(),W(U,1,1,()=>{U=null}),He());let h=d;d=he(v),d===h?Z[d].p(v,S):(Ne(),W(Z[h],1,1,()=>{Z[h]=null}),He(),b=Z[d],b?b.p(v,S):(b=Z[d]=ce[d](v),b.c()),N(b,1),b.m(e,null))},i(v){F||(N(n.$$.fragment,v),N(U),N(b),F=!0)},o(v){W(n.$$.fragment,v),W(U),W(b),F=!1},d(v){v&&m(e),we(n),U&&U.d(),Z[d].d(),v&&m(C),v&&m(L),l[24](null),j=!1,K()}}}function Ps(l){const e=[];for(let t of l)if("interoMapPoints"in t){const n=Ds(t.interoMapPoints);e.push(n)}return e}function Ds(l){return JSON.parse(l)}function Ss(l){const e=[],t={MaleFront:[],MaleBack:[],FemaleFront:[],FemaleBack:[]};for(let n=0,i=l.length;n<i;++n){const s=l[n],a=Object.keys(s);e.push({id:n+1,surveyData:s});for(let o of a){const r=s[o];r&&r.length>0&&t[o].push(r)}}return[e,t]}function Is(l,e,t){let n,i=!1,s,a,o,r,c=me.LookingGlass,u=[],d={MaleFront:[],MaleBack:[],FemaleFront:[],FemaleBack:[]};function b(){n.click()}function C(){t(3,i=!1),t(14,u=[]),d={MaleFront:[],MaleBack:[],FemaleFront:[],FemaleBack:[]}}function L(){t(6,o=void 0),r.$destroy()}function F(){lt.selectedParticipantIdx.set(0),et.mapColors.FemaleFront.set("#0000FF"),et.mapColors.FemaleBack.set("#0000FF"),et.mapColors.MaleFront.set("#0000FF"),et.mapColors.MaleBack.set("#0000FF"),ValenceMapStore.mapColors.FemaleFront.set("#0000FF"),ValenceMapStore.mapColors.FemaleBack.set("#0000FF"),ValenceMapStore.mapColors.MaleFront.set("#0000FF"),ValenceMapStore.mapColors.MaleBack.set("#0000FF")}function j(){C(),L(),F()}function K(D){r.setView(D),s.close()}function U(){n.files&&n.files.length>0&&(r&&j(),ce(n.files[0]))}function ce(D){Et.parse(D,{worker:!0,header:!0,complete:Z})}function Z(D){const k=Ps(D.data);t(14,[u,d]=Ss(k),u);const y=f(c);t(6,o=y),t(3,i=!0)}function he(){const D={tabs:[]};let k;for(k in d)D.tabs.push({title:k,component:Jn,props:{workspace:r,persona:k,participantsDrawings:d[k]},isDisabled:!0});return D.caption="Looking Glass",D}function v(){const D={tabs:[]};let k=!0,y;for(y in d)D.tabs.push({title:y,component:ts,props:{persona:y,participantsStrokes:d[y],totalParticipants:u.length},isActive:k}),k=!1;return D.caption="Density Map",D}function S(){const D={tabs:[]};let k=!0,y;for(y in d)D.tabs.push({title:y,component:rs,props:{persona:y,participantsStrokes:d[y],totalParticipants:u.length},isActive:k}),k=!1;return D.caption="Valence Map",D}function f(D){switch(D){case me.LookingGlass:return he();case me.DensityMap:return v();case me.ValenceMap:return S();default:return he()}}function h(D){t(1,c=D),a.close()}function p(){const D=r.getActiveComponent();if(D){const k=D.getImage(),y=document.createElement("a");y.href=k.data,y.target="_blank",y.download=`InteroMap_${k.name}.png`,y.click()}}function w(){const k=[["Participant Number","Stroke Valence","Stroke Intensity","Brush Size (pixels)"]];for(let z of u)for(let ie in z.surveyData)for(let ee of z.surveyData[ie])k.push([z.id,ee.valence,ee.intensity,ee.brushSize]);const y=Et.unparse(k);return"data:text/csv;base64,"+btoa(y)}function E(){const D=w(),k=document.createElement("a");k.href=D,k.target="_blank",k.download="InteroMap-Data.csv",k.click()}const x=()=>K("single"),H=()=>K("dual"),le=()=>K("grid");function P(D){ye[D?"unshift":"push"](()=>{s=D,t(4,s)})}const _=()=>h(me.LookingGlass),V=()=>h(me.DensityMap),A=()=>h(me.ValenceMap);function X(D){ye[D?"unshift":"push"](()=>{a=D,t(5,a)})}function G(D){ye[D?"unshift":"push"](()=>{r=D,t(0,r)})}function I(D){ye[D?"unshift":"push"](()=>{n=D,t(2,n)})}return l.$$.update=()=>{if(l.$$.dirty[0]&16387&&r&&u.length>0&&c===me.LookingGlass){const D=lt.selectedParticipantIdx.subscribe(k=>{const y=Object.keys(u[k].surveyData);r.enableTabs(y)});r.$on("destroy",D)}l.$$.dirty[0]&2&&c&&t(6,o=f(c))},[r,c,n,i,s,a,o,b,j,K,U,h,p,E,u,x,H,le,P,_,V,A,X,G,I]}class xs extends Ee{constructor(e){super(),Pe(this,e,Is,Es,_e,{},null,[-1,-1])}}export{xs as default};
