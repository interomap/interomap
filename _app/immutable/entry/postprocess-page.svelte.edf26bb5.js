var Xt=Object.defineProperty;var en=(l,e,t)=>e in l?Xt(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var Qe=(l,e,t)=>(en(l,typeof e!="symbol"?e+"":e,t),t);import{S as Ee,i as Pe,s as _e,k as $,q as ne,a as K,l as B,m as x,r as se,h as m,c as J,n as g,Y as ae,b as T,G as I,K as Ie,u as Oe,g as V,v as Ve,d as H,f as Ne,N as dt,a1 as tn,C as pt,D as gt,E as mt,F as _t,a2 as nn,w as ye,a3 as sn,R as ut,H as G,a4 as rn,O as bt,o as tt,P as it,e as $e,X as rt,a5 as wt,p as ft,T as Ge,y as be,z as ve,A as ke,a6 as Gt,a7 as qt,B as we,J as We,a8 as an,a9 as ln,U as Xe,aa as Ct,$ as De,a0 as Se}from"../chunks/index.87c45b08.js";import{j as on,g as cn,k as un,p as vt,b as Ye,a as et,e as nt,r as Kt,d as Jt,P as me}from"../chunks/index.3e9be703.js";import{w as st}from"../chunks/index.4e444171.js";var Qt={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(l,e){(function(t,n){l.exports=n()})(on,function t(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i=!n.document&&!!n.postMessage,s=n.IS_PAPA_WORKER||!1,a={},o=0,r={parse:function(f,h){var d=(h=h||{}).dynamicTyping||!1;if(P(d)&&(h.dynamicTypingFunction=d,d={}),h.dynamicTyping=d,h.transform=!!P(h.transform)&&h.transform,h.worker&&r.WORKERS_SUPPORTED){var w=function(){if(!r.WORKERS_SUPPORTED)return!1;var A=(Z=n.URL||n.webkitURL||null,W=t.toString(),r.BLOB_URL||(r.BLOB_URL=Z.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",W,")();"],{type:"text/javascript"})))),L=new n.Worker(A),Z,W;return L.onmessage=U,L.id=o++,a[L.id]=L}();return w.userStep=h.step,w.userChunk=h.chunk,w.userComplete=h.complete,w.userError=h.error,h.step=P(h.step),h.chunk=P(h.chunk),h.complete=P(h.complete),h.error=P(h.error),delete h.worker,void w.postMessage({input:f,config:h,workerId:w.id})}var y=null;return r.NODE_STREAM_INPUT,typeof f=="string"?(f=function(A){return A.charCodeAt(0)===65279?A.slice(1):A}(f),y=h.download?new p(h):new C(h)):f.readable===!0&&P(f.read)&&P(f.on)?y=new F(h):(n.File&&f instanceof File||f instanceof Object)&&(y=new _(h)),y.stream(f)},unparse:function(f,h){var d=!1,w=!0,y=",",A=`\r
`,L='"',Z=L+L,W=!1,b=null,N=!1;(function(){if(typeof h=="object"){if(typeof h.delimiter!="string"||r.BAD_DELIMITERS.filter(function(S){return h.delimiter.indexOf(S)!==-1}).length||(y=h.delimiter),(typeof h.quotes=="boolean"||typeof h.quotes=="function"||Array.isArray(h.quotes))&&(d=h.quotes),typeof h.skipEmptyLines!="boolean"&&typeof h.skipEmptyLines!="string"||(W=h.skipEmptyLines),typeof h.newline=="string"&&(A=h.newline),typeof h.quoteChar=="string"&&(L=h.quoteChar),typeof h.header=="boolean"&&(w=h.header),Array.isArray(h.columns)){if(h.columns.length===0)throw new Error("Option columns is empty");b=h.columns}h.escapeChar!==void 0&&(Z=h.escapeChar+L),(typeof h.escapeFormulae=="boolean"||h.escapeFormulae instanceof RegExp)&&(N=h.escapeFormulae instanceof RegExp?h.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var R=new RegExp(j(L),"g");if(typeof f=="string"&&(f=JSON.parse(f)),Array.isArray(f)){if(!f.length||Array.isArray(f[0]))return he(null,f,W);if(typeof f[0]=="object")return he(b||Object.keys(f[0]),f,W)}else if(typeof f=="object")return typeof f.data=="string"&&(f.data=JSON.parse(f.data)),Array.isArray(f.data)&&(f.fields||(f.fields=f.meta&&f.meta.fields||b),f.fields||(f.fields=Array.isArray(f.data[0])?f.fields:typeof f.data[0]=="object"?Object.keys(f.data[0]):[]),Array.isArray(f.data[0])||typeof f.data[0]=="object"||(f.data=[f.data])),he(f.fields||[],f.data||[],W);throw new Error("Unable to serialize unrecognized input");function he(S,D,k){var E="";typeof S=="string"&&(S=JSON.parse(S)),typeof D=="string"&&(D=JSON.parse(D));var z=Array.isArray(S)&&0<S.length,ie=!Array.isArray(D[0]);if(z&&w){for(var ee=0;ee<S.length;ee++)0<ee&&(E+=y),E+=X(S[ee],ee);0<D.length&&(E+=A)}for(var O=0;O<D.length;O++){var q=z?S.length:D[O].length,ce=!1,ge=z?Object.keys(D[O]).length===0:D[O].length===0;if(k&&!z&&(ce=k==="greedy"?D[O].join("").trim()==="":D[O].length===1&&D[O][0].length===0),k==="greedy"&&z){for(var re=[],Ce=0;Ce<q;Ce++){var de=ie?S[Ce]:Ce;re.push(D[O][de])}ce=re.join("").trim()===""}if(!ce){for(var le=0;le<q;le++){0<le&&!ge&&(E+=y);var Fe=z&&ie?S[le]:le;E+=X(D[O][Fe],le)}O<D.length-1&&(!k||0<q&&!ge)&&(E+=A)}}return E}function X(S,D){if(S==null)return"";if(S.constructor===Date)return JSON.stringify(S).slice(1,25);var k=!1;N&&typeof S=="string"&&N.test(S)&&(S="'"+S,k=!0);var E=S.toString().replace(R,Z);return(k=k||d===!0||typeof d=="function"&&d(S,D)||Array.isArray(d)&&d[D]||function(z,ie){for(var ee=0;ee<ie.length;ee++)if(-1<z.indexOf(ie[ee]))return!0;return!1}(E,r.BAD_DELIMITERS)||-1<E.indexOf(y)||E.charAt(0)===" "||E.charAt(E.length-1)===" ")?L+E+L:E}}};if(r.RECORD_SEP=String.fromCharCode(30),r.UNIT_SEP=String.fromCharCode(31),r.BYTE_ORDER_MARK="\uFEFF",r.BAD_DELIMITERS=["\r",`
`,'"',r.BYTE_ORDER_MARK],r.WORKERS_SUPPORTED=!i&&!!n.Worker,r.NODE_STREAM_INPUT=1,r.LocalChunkSize=10485760,r.RemoteChunkSize=5242880,r.DefaultDelimiter=",",r.Parser=Q,r.ParserHandle=M,r.NetworkStreamer=p,r.FileStreamer=_,r.StringStreamer=C,r.ReadableStreamStreamer=F,n.jQuery){var c=n.jQuery;c.fn.parse=function(f){var h=f.config||{},d=[];return this.each(function(A){if(!(c(this).prop("tagName").toUpperCase()==="INPUT"&&c(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var L=0;L<this.files.length;L++)d.push({file:this.files[L],inputElem:this,instanceConfig:c.extend({},h)})}),w(),this;function w(){if(d.length!==0){var A,L,Z,W,b=d[0];if(P(f.before)){var N=f.before(b.file,b.inputElem);if(typeof N=="object"){if(N.action==="abort")return A="AbortError",L=b.file,Z=b.inputElem,W=N.reason,void(P(f.error)&&f.error({name:A},L,Z,W));if(N.action==="skip")return void y();typeof N.config=="object"&&(b.instanceConfig=c.extend(b.instanceConfig,N.config))}else if(N==="skip")return void y()}var R=b.instanceConfig.complete;b.instanceConfig.complete=function(he){P(R)&&R(he,b.file,b.inputElem),y()},r.parse(b.file,b.instanceConfig)}else P(f.complete)&&f.complete()}function y(){d.splice(0,1),w()}}}function u(f){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(h){var d=fe(h);d.chunkSize=parseInt(d.chunkSize),h.step||h.chunk||(d.chunkSize=null),this._handle=new M(d),(this._handle.streamer=this)._config=d}.call(this,f),this.parseChunk=function(h,d){if(this.isFirstChunk&&P(this._config.beforeFirstChunk)){var w=this._config.beforeFirstChunk(h);w!==void 0&&(h=w)}this.isFirstChunk=!1,this._halted=!1;var y=this._partialLine+h;this._partialLine="";var A=this._handle.parse(y,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var L=A.meta.cursor;this._finished||(this._partialLine=y.substring(L-this._baseIndex),this._baseIndex=L),A&&A.data&&(this._rowCount+=A.data.length);var Z=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)n.postMessage({results:A,workerId:r.WORKER_ID,finished:Z});else if(P(this._config.chunk)&&!d){if(this._config.chunk(A,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);A=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(A.data),this._completeResults.errors=this._completeResults.errors.concat(A.errors),this._completeResults.meta=A.meta),this._completed||!Z||!P(this._config.complete)||A&&A.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),Z||A&&A.meta.paused||this._nextChunk(),A}this._halted=!0},this._sendError=function(h){P(this._config.error)?this._config.error(h):s&&this._config.error&&n.postMessage({workerId:r.WORKER_ID,error:h,finished:!1})}}function p(f){var h;(f=f||{}).chunkSize||(f.chunkSize=r.RemoteChunkSize),u.call(this,f),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(d){this._input=d,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(h=new XMLHttpRequest,this._config.withCredentials&&(h.withCredentials=this._config.withCredentials),i||(h.onload=v(this._chunkLoaded,this),h.onerror=v(this._chunkError,this)),h.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var d=this._config.downloadRequestHeaders;for(var w in d)h.setRequestHeader(w,d[w])}if(this._config.chunkSize){var y=this._start+this._config.chunkSize-1;h.setRequestHeader("Range","bytes="+this._start+"-"+y)}try{h.send(this._config.downloadRequestBody)}catch(A){this._chunkError(A.message)}i&&h.status===0&&this._chunkError()}},this._chunkLoaded=function(){h.readyState===4&&(h.status<200||400<=h.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:h.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(d){var w=d.getResponseHeader("Content-Range");return w===null?-1:parseInt(w.substring(w.lastIndexOf("/")+1))}(h),this.parseChunk(h.responseText)))},this._chunkError=function(d){var w=h.statusText||d;this._sendError(new Error(w))}}function _(f){var h,d;(f=f||{}).chunkSize||(f.chunkSize=r.LocalChunkSize),u.call(this,f);var w=typeof FileReader<"u";this.stream=function(y){this._input=y,d=y.slice||y.webkitSlice||y.mozSlice,w?((h=new FileReader).onload=v(this._chunkLoaded,this),h.onerror=v(this._chunkError,this)):h=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var y=this._input;if(this._config.chunkSize){var A=Math.min(this._start+this._config.chunkSize,this._input.size);y=d.call(y,this._start,A)}var L=h.readAsText(y,this._config.encoding);w||this._chunkLoaded({target:{result:L}})},this._chunkLoaded=function(y){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(y.target.result)},this._chunkError=function(){this._sendError(h.error)}}function C(f){var h;u.call(this,f=f||{}),this.stream=function(d){return h=d,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var d,w=this._config.chunkSize;return w?(d=h.substring(0,w),h=h.substring(w)):(d=h,h=""),this._finished=!h,this.parseChunk(d)}}}function F(f){u.call(this,f=f||{});var h=[],d=!0,w=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(y){this._input=y,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){w&&h.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),h.length?this.parseChunk(h.shift()):d=!0},this._streamData=v(function(y){try{h.push(typeof y=="string"?y:y.toString(this._config.encoding)),d&&(d=!1,this._checkIsFinished(),this.parseChunk(h.shift()))}catch(A){this._streamError(A)}},this),this._streamError=v(function(y){this._streamCleanUp(),this._sendError(y)},this),this._streamEnd=v(function(){this._streamCleanUp(),w=!0,this._streamData("")},this),this._streamCleanUp=v(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function M(f){var h,d,w,y=Math.pow(2,53),A=-y,L=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Z=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,W=this,b=0,N=0,R=!1,he=!1,X=[],S={data:[],errors:[],meta:{}};if(P(f.step)){var D=f.step;f.step=function(O){if(S=O,z())E();else{if(E(),S.data.length===0)return;b+=O.data.length,f.preview&&b>f.preview?d.abort():(S.data=S.data[0],D(S,W))}}}function k(O){return f.skipEmptyLines==="greedy"?O.join("").trim()==="":O.length===1&&O[0].length===0}function E(){return S&&w&&(ee("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+r.DefaultDelimiter+"'"),w=!1),f.skipEmptyLines&&(S.data=S.data.filter(function(O){return!k(O)})),z()&&function(){if(!S)return;function O(ce,ge){P(f.transformHeader)&&(ce=f.transformHeader(ce,ge)),X.push(ce)}if(Array.isArray(S.data[0])){for(var q=0;z()&&q<S.data.length;q++)S.data[q].forEach(O);S.data.splice(0,1)}else S.data.forEach(O)}(),function(){if(!S||!f.header&&!f.dynamicTyping&&!f.transform)return S;function O(ce,ge){var re,Ce=f.header?{}:[];for(re=0;re<ce.length;re++){var de=re,le=ce[re];f.header&&(de=re>=X.length?"__parsed_extra":X[re]),f.transform&&(le=f.transform(le,de)),le=ie(de,le),de==="__parsed_extra"?(Ce[de]=Ce[de]||[],Ce[de].push(le)):Ce[de]=le}return f.header&&(re>X.length?ee("FieldMismatch","TooManyFields","Too many fields: expected "+X.length+" fields but parsed "+re,N+ge):re<X.length&&ee("FieldMismatch","TooFewFields","Too few fields: expected "+X.length+" fields but parsed "+re,N+ge)),Ce}var q=1;return!S.data.length||Array.isArray(S.data[0])?(S.data=S.data.map(O),q=S.data.length):S.data=O(S.data,0),f.header&&S.meta&&(S.meta.fields=X),N+=q,S}()}function z(){return f.header&&X.length===0}function ie(O,q){return ce=O,f.dynamicTypingFunction&&f.dynamicTyping[ce]===void 0&&(f.dynamicTyping[ce]=f.dynamicTypingFunction(ce)),(f.dynamicTyping[ce]||f.dynamicTyping)===!0?q==="true"||q==="TRUE"||q!=="false"&&q!=="FALSE"&&(function(ge){if(L.test(ge)){var re=parseFloat(ge);if(A<re&&re<y)return!0}return!1}(q)?parseFloat(q):Z.test(q)?new Date(q):q===""?null:q):q;var ce}function ee(O,q,ce,ge){var re={type:O,code:q,message:ce};ge!==void 0&&(re.row=ge),S.errors.push(re)}this.parse=function(O,q,ce){var ge=f.quoteChar||'"';if(f.newline||(f.newline=function(de,le){de=de.substring(0,1048576);var Fe=new RegExp(j(le)+"([^]*?)"+j(le),"gm"),Ae=(de=de.replace(Fe,"")).split("\r"),Re=de.split(`
`),Be=1<Re.length&&Re[0].length<Ae[0].length;if(Ae.length===1||Be)return`
`;for(var Me=0,ue=0;ue<Ae.length;ue++)Ae[ue][0]===`
`&&Me++;return Me>=Ae.length/2?`\r
`:"\r"}(O,ge)),w=!1,f.delimiter)P(f.delimiter)&&(f.delimiter=f.delimiter(O),S.meta.delimiter=f.delimiter);else{var re=function(de,le,Fe,Ae,Re){var Be,Me,ue,pe;Re=Re||[",","	","|",";",r.RECORD_SEP,r.UNIT_SEP];for(var qe=0;qe<Re.length;qe++){var te=Re[qe],Je=0,ze=0,Ke=0;ue=void 0;for(var je=new Q({comments:Ae,delimiter:te,newline:le,preview:10}).parse(de),He=0;He<je.data.length;He++)if(Fe&&k(je.data[He]))Ke++;else{var Ue=je.data[He].length;ze+=Ue,ue!==void 0?0<Ue&&(Je+=Math.abs(Ue-ue),ue=Ue):ue=Ue}0<je.data.length&&(ze/=je.data.length-Ke),(Me===void 0||Je<=Me)&&(pe===void 0||pe<ze)&&1.99<ze&&(Me=Je,Be=te,pe=ze)}return{successful:!!(f.delimiter=Be),bestDelimiter:Be}}(O,f.newline,f.skipEmptyLines,f.comments,f.delimitersToGuess);re.successful?f.delimiter=re.bestDelimiter:(w=!0,f.delimiter=r.DefaultDelimiter),S.meta.delimiter=f.delimiter}var Ce=fe(f);return f.preview&&f.header&&Ce.preview++,h=O,d=new Q(Ce),S=d.parse(h,q,ce),E(),R?{meta:{paused:!0}}:S||{meta:{paused:!1}}},this.paused=function(){return R},this.pause=function(){R=!0,d.abort(),h=P(f.chunk)?"":h.substring(d.getCharIndex())},this.resume=function(){W.streamer._halted?(R=!1,W.streamer.parseChunk(h,!0)):setTimeout(W.resume,3)},this.aborted=function(){return he},this.abort=function(){he=!0,d.abort(),S.meta.aborted=!0,P(f.complete)&&f.complete(S),h=""}}function j(f){return f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Q(f){var h,d=(f=f||{}).delimiter,w=f.newline,y=f.comments,A=f.step,L=f.preview,Z=f.fastMode,W=h=f.quoteChar===void 0||f.quoteChar===null?'"':f.quoteChar;if(f.escapeChar!==void 0&&(W=f.escapeChar),(typeof d!="string"||-1<r.BAD_DELIMITERS.indexOf(d))&&(d=","),y===d)throw new Error("Comment character same as delimiter");y===!0?y="#":(typeof y!="string"||-1<r.BAD_DELIMITERS.indexOf(y))&&(y=!1),w!==`
`&&w!=="\r"&&w!==`\r
`&&(w=`
`);var b=0,N=!1;this.parse=function(R,he,X){if(typeof R!="string")throw new Error("Input must be a string");var S=R.length,D=d.length,k=w.length,E=y.length,z=P(A),ie=[],ee=[],O=[],q=b=0;if(!R)return Te();if(f.header&&!he){var ce=R.split(w)[0].split(d),ge=[],re={},Ce=!1;for(var de in ce){var le=ce[de];P(f.transformHeader)&&(le=f.transformHeader(le,de));var Fe=le,Ae=re[le]||0;for(0<Ae&&(Ce=!0,Fe=le+"_"+Ae),re[le]=Ae+1;ge.includes(Fe);)Fe=Fe+"_"+Ae;ge.push(Fe)}if(Ce){var Re=R.split(w);Re[0]=ge.join(d),R=Re.join(w)}}if(Z||Z!==!1&&R.indexOf(h)===-1){for(var Be=R.split(w),Me=0;Me<Be.length;Me++){if(O=Be[Me],b+=O.length,Me!==Be.length-1)b+=w.length;else if(X)return Te();if(!y||O.substring(0,E)!==y){if(z){if(ie=[],Ke(O.split(d)),at(),N)return Te()}else Ke(O.split(d));if(L&&L<=Me)return ie=ie.slice(0,L),Te(!0)}}return Te()}for(var ue=R.indexOf(d,b),pe=R.indexOf(w,b),qe=new RegExp(j(W)+j(h),"g"),te=R.indexOf(h,b);;)if(R[b]!==h)if(y&&O.length===0&&R.substring(b,b+E)===y){if(pe===-1)return Te();b=pe+k,pe=R.indexOf(w,b),ue=R.indexOf(d,b)}else if(ue!==-1&&(ue<pe||pe===-1))O.push(R.substring(b,ue)),b=ue+D,ue=R.indexOf(d,b);else{if(pe===-1)break;if(O.push(R.substring(b,pe)),Ue(pe+k),z&&(at(),N))return Te();if(L&&ie.length>=L)return Te(!0)}else for(te=b,b++;;){if((te=R.indexOf(h,te+1))===-1)return X||ee.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ie.length,index:b}),He();if(te===S-1)return He(R.substring(b,te).replace(qe,h));if(h!==W||R[te+1]!==W){if(h===W||te===0||R[te-1]!==W){ue!==-1&&ue<te+1&&(ue=R.indexOf(d,te+1)),pe!==-1&&pe<te+1&&(pe=R.indexOf(w,te+1));var Je=je(pe===-1?ue:Math.min(ue,pe));if(R.substr(te+1+Je,D)===d){O.push(R.substring(b,te).replace(qe,h)),R[b=te+1+Je+D]!==h&&(te=R.indexOf(h,b)),ue=R.indexOf(d,b),pe=R.indexOf(w,b);break}var ze=je(pe);if(R.substring(te+1+ze,te+1+ze+k)===w){if(O.push(R.substring(b,te).replace(qe,h)),Ue(te+1+ze+k),ue=R.indexOf(d,b),te=R.indexOf(h,b),z&&(at(),N))return Te();if(L&&ie.length>=L)return Te(!0);break}ee.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ie.length,index:b}),te++}}else te++}return He();function Ke(xe){ie.push(xe),q=b}function je(xe){var kt=0;if(xe!==-1){var ot=R.substring(te+1,xe);ot&&ot.trim()===""&&(kt=ot.length)}return kt}function He(xe){return X||(xe===void 0&&(xe=R.substring(b)),O.push(xe),b=S,Ke(O),z&&at()),Te()}function Ue(xe){b=xe,Ke(O),O=[],pe=R.indexOf(w,b)}function Te(xe){return{data:ie,errors:ee,meta:{delimiter:d,linebreak:w,aborted:N,truncated:!!xe,cursor:q+(he||0)}}}function at(){A(Te()),ie=[],ee=[]}},this.abort=function(){N=!0},this.getCharIndex=function(){return b}}function U(f){var h=f.data,d=a[h.workerId],w=!1;if(h.error)d.userError(h.error,h.file);else if(h.results&&h.results.data){var y={abort:function(){w=!0,oe(h.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Y,resume:Y};if(P(d.userStep)){for(var A=0;A<h.results.data.length&&(d.userStep({data:h.results.data[A],errors:h.results.errors,meta:h.results.meta},y),!w);A++);delete h.results}else P(d.userChunk)&&(d.userChunk(h.results,y,h.file),delete h.results)}h.finished&&!w&&oe(h.workerId,h.results)}function oe(f,h){var d=a[f];P(d.userComplete)&&d.userComplete(h),d.terminate(),delete a[f]}function Y(){throw new Error("Not implemented.")}function fe(f){if(typeof f!="object"||f===null)return f;var h=Array.isArray(f)?[]:{};for(var d in f)h[d]=fe(f[d]);return h}function v(f,h){return function(){f.apply(h,arguments)}}function P(f){return typeof f=="function"}return s&&(n.onmessage=function(f){var h=f.data;if(r.WORKER_ID===void 0&&h&&(r.WORKER_ID=h.workerId),typeof h.input=="string")n.postMessage({workerId:r.WORKER_ID,results:r.parse(h.input,h.config),finished:!0});else if(n.File&&h.input instanceof File||h.input instanceof Object){var d=r.parse(h.input,h.config);d&&n.postMessage({workerId:r.WORKER_ID,results:d,finished:!0})}}),(p.prototype=Object.create(u.prototype)).constructor=p,(_.prototype=Object.create(u.prototype)).constructor=_,(C.prototype=Object.create(C.prototype)).constructor=C,(F.prototype=Object.create(u.prototype)).constructor=F,r})})(Qt);var fn=Qt.exports;const yt=cn(fn),lt={selectedParticipantIdx:st(0)},Ze={mapColors:{FemaleFront:st("#0000FF"),FemaleBack:st("#0000FF"),MaleFront:st("#0000FF"),MaleBack:st("#0000FF")}};function Et(l){let e,t,n;const i=l[8].default,s=pt(i,l,l[7],null);return{c(){e=$("ul"),s&&s.c(),this.h()},l(a){e=B(a,"UL",{class:!0});var o=x(e);s&&s.l(o),o.forEach(m),this.h()},h(){g(e,"class","absolute top-full left-0 w-48 p-1 bg-neutral-700 shadow")},m(a,o){T(a,e,o),s&&s.m(e,null),n=!0},p(a,o){s&&s.p&&(!n||o&128)&&gt(s,i,a,a[7],n?_t(i,a[7],o,null):mt(a[7]),null)},i(a){n||(V(s,a),t&&t.end(1),n=!0)},o(a){H(s,a),t=nn(e,un,{duration:100}),n=!1},d(a){a&&m(e),s&&s.d(a),a&&t&&t.end()}}}function hn(l){let e,t,n,i,s,a,o,r=l[0]&&Et(l);return{c(){e=$("div"),t=$("button"),n=ne(l[1]),i=K(),r&&r.c(),this.h()},l(c){e=B(c,"DIV",{class:!0});var u=x(e);t=B(u,"BUTTON",{class:!0});var p=x(t);n=se(p,l[1]),p.forEach(m),i=J(u),r&&r.l(u),u.forEach(m),this.h()},h(){g(t,"class","h-full px-3 text-neutral-100 text-xs"),ae(t,"bg-neutral-700",l[0]),g(e,"class","relative flex items-center h-full")},m(c,u){T(c,e,u),I(e,t),I(t,n),I(e,i),r&&r.m(e,null),l[9](e),s=!0,a||(o=[Ie(window,"click",l[4]),Ie(t,"click",l[3])],a=!0)},p(c,[u]){(!s||u&2)&&Oe(n,c[1]),(!s||u&1)&&ae(t,"bg-neutral-700",c[0]),c[0]?r?(r.p(c,u),u&1&&V(r,1)):(r=Et(c),r.c(),V(r,1),r.m(e,null)):r&&(Ve(),H(r,1,1,()=>{r=null}),Ne())},i(c){s||(V(r),s=!0)},o(c){H(r),s=!1},d(c){c&&m(e),r&&r.d(),l[9](null),a=!1,dt(o)}}}function dn(l,e,t){let{$$slots:n={},$$scope:i}=e,{title:s}=e,{isOpen:a=!1}=e,{enableIcon:o=!1}=e;function r(){t(0,a=!1)}let c;tn("menu",{enableIcon:o});function u(){t(0,a=!a)}function p(C){C.target instanceof Node&&c.contains(C.target)===!1&&t(0,a=!1)}function _(C){ye[C?"unshift":"push"](()=>{c=C,t(2,c)})}return l.$$set=C=>{"title"in C&&t(1,s=C.title),"isOpen"in C&&t(0,a=C.isOpen),"enableIcon"in C&&t(5,o=C.enableIcon),"$$scope"in C&&t(7,i=C.$$scope)},[a,s,c,u,p,o,r,i,n,_]}class ht extends Ee{constructor(e){super(),Pe(this,e,dn,hn,_e,{title:1,isOpen:0,enableIcon:5,close:6})}get close(){return this.$$.ctx[6]}}const pn=l=>({isActive:l&1}),Pt=l=>({isActive:l[0]});function gn(l){let e,t;const n=l[3].icon,i=pt(n,l,l[2],Pt);return{c(){e=$("span"),i&&i.c(),this.h()},l(s){e=B(s,"SPAN",{class:!0});var a=x(e);i&&i.l(a),a.forEach(m),this.h()},h(){g(e,"class","w-[16px] mr-1")},m(s,a){T(s,e,a),i&&i.m(e,null),t=!0},p(s,a){i&&i.p&&(!t||a&5)&&gt(i,n,s,s[2],t?_t(n,s[2],a,pn):mt(s[2]),Pt)},i(s){t||(V(i,s),t=!0)},o(s){H(i,s),t=!1},d(s){s&&m(e),i&&i.d(s)}}}function mn(l){let e,t,n,i,s,a,o=l[1]&&gn(l);const r=l[3].default,c=pt(r,l,l[2],null);return{c(){e=$("li"),t=$("button"),o&&o.c(),n=K(),c&&c.c(),this.h()},l(u){e=B(u,"LI",{class:!0});var p=x(e);t=B(p,"BUTTON",{class:!0});var _=x(t);o&&o.l(_),n=J(_),c&&c.l(_),_.forEach(m),p.forEach(m),this.h()},h(){g(t,"class","flex items-center w-full py-1 pr-2 "+(l[1]?"pl-1":"pl-2")+" text-xs text-neutral-100 text-left"),ae(t,"hover:bg-blue-500",!l[0]),g(e,"class","w-full")},m(u,p){T(u,e,p),I(e,t),o&&o.m(t,null),I(t,n),c&&c.m(t,null),i=!0,s||(a=Ie(e,"click",l[4]),s=!0)},p(u,[p]){u[1]&&o.p(u,p),c&&c.p&&(!i||p&4)&&gt(c,r,u,u[2],i?_t(r,u[2],p,null):mt(u[2]),null),(!i||p&1)&&ae(t,"hover:bg-blue-500",!u[0])},i(u){i||(V(o),V(c,u),i=!0)},o(u){H(o),H(c,u),i=!1},d(u){u&&m(e),o&&o.d(),c&&c.d(u),s=!1,a()}}}function _n(l,e,t){let{$$slots:n={},$$scope:i}=e,{isActive:s=!1}=e;const{enableIcon:a}=sn("menu");function o(r){ut.call(this,l,r)}return l.$$set=r=>{"isActive"in r&&t(0,s=r.isActive),"$$scope"in r&&t(2,i=r.$$scope)},[s,a,i,n,o]}class Le extends Ee{constructor(e){super(),Pe(this,e,_n,mn,_e,{isActive:0})}}function bn(l){let e;return{c(){e=$("hr"),this.h()},l(t){e=B(t,"HR",{class:!0}),this.h()},h(){g(e,"class","my-0.5 border-0 border-b border-neutral-600")},m(t,n){T(t,e,n)},p:G,i:G,o:G,d(t){t&&m(e)}}}class vn extends Ee{constructor(e){super(),Pe(this,e,null,bn,_e,{})}}function Dt(l,e,t){const n=l.slice();return n[23]=e[t],n}function St(l){let e,t=l[23].title+"",n,i,s,a,o;function r(){return l[15](l[23])}return{c(){e=$("button"),n=ne(t),i=K(),this.h()},l(c){e=B(c,"BUTTON",{class:!0});var u=x(e);n=se(u,t),i=J(u),u.forEach(m),this.h()},h(){g(e,"class",s=wt(l[23].isDisabled?"hidden":"panel-tab")+" svelte-1oevamb"),ae(e,"panel-config",l[1]&&l[6]===l[23]),ae(e,"active",l[6]===l[23]),ae(e,"active-panel",l[5]&&l[6]===l[23])},m(c,u){T(c,e,u),I(e,n),I(e,i),a||(o=Ie(e,"click",r),a=!0)},p(c,u){l=c,u&1&&t!==(t=l[23].title+"")&&Oe(n,t),u&1&&s!==(s=wt(l[23].isDisabled?"hidden":"panel-tab")+" svelte-1oevamb")&&g(e,"class",s),u&67&&ae(e,"panel-config",l[1]&&l[6]===l[23]),u&65&&ae(e,"active",l[6]===l[23]),u&97&&ae(e,"active-panel",l[5]&&l[6]===l[23])},d(c){c&&m(e),a=!1,o()}}}function It(l){let e,t=l[0],n=[];for(let i=0;i<t.length;i+=1)n[i]=St(Dt(l,t,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=$e()},l(i){for(let s=0;s<n.length;s+=1)n[s].l(i);e=$e()},m(i,s){for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(i,s);T(i,e,s)},p(i,s){if(s&355){t=i[0];let a;for(a=0;a<t.length;a+=1){const o=Dt(i,t,a);n[a]?n[a].p(o,s):(n[a]=St(o),n[a].c(),n[a].m(e.parentNode,e))}for(;a<n.length;a+=1)n[a].d(1);n.length=t.length}},d(i){rt(n,i),i&&m(e)}}}function At(l){let e,t;return{c(){e=$("span"),t=ne(l[2]),this.h()},l(n){e=B(n,"SPAN",{class:!0});var i=x(e);t=se(i,l[2]),i.forEach(m),this.h()},h(){g(e,"class","absolute top-4 right-4 py-1 px-2 bg-neutral-900 shadow bg-opacity-50 text-neutral-100 text-xs")},m(n,i){T(n,e,i),I(e,t),l[16](e)},p(n,i){i&4&&Oe(t,n[2])},d(n){n&&m(e),l[16](null)}}}function kn(l){let e,t,n=l[5],i,s,a,o,r=It(l),c=l[2]&&At(l);return{c(){e=$("div"),t=$("div"),r.c(),i=K(),s=$("div"),c&&c.c(),this.h()},l(u){e=B(u,"DIV",{class:!0});var p=x(e);t=B(p,"DIV",{class:!0});var _=x(t);r.l(_),_.forEach(m),i=J(p),s=B(p,"DIV",{class:!0});var C=x(s);c&&c.l(C),C.forEach(m),p.forEach(m),this.h()},h(){g(t,"class","panel-tabs w-full h-5 svelte-1oevamb"),g(s,"class","panel relative flex-grow w-full"),g(e,"class","panel-container svelte-1oevamb")},m(u,p){T(u,e,p),I(e,t),r.m(t,null),I(e,i),I(e,s),c&&c.m(s,null),l[17](s),a||(o=Ie(e,"click",l[7]),a=!0)},p(u,[p]){p&32&&_e(n,n=u[5])?(r.d(1),r=It(u),r.c(),r.m(t,null)):r.p(u,p),u[2]?c?c.p(u,p):(c=At(u),c.c(),c.m(s,null)):c&&(c.d(1),c=null)},i:G,o:G,d(u){u&&m(e),r.d(u),c&&c.d(),l[17](null),a=!1,o()}}}function wn(l,e,t){let{tabs:n}=e,{isConfig:i=!1}=e,{caption:s=void 0}=e;function a(){let d;j.getConfigPanelsProps&&(d=j.getConfigPanelsProps()),t(5,M=!0),U("activePanelChange",{source:_,configPanelsProps:d})}function o(){t(5,M=!1)}function r(d){oe(),j=Y(d),t(6,Q=d),i===!1&&a()}function c(d){const w=d.find(y=>y.title===Q.title);if(w===void 0||w.isDisabled){const y=d.find(A=>A.isDisabled===!1);if(y)r(y);else throw"Error: All tabs are disabled, could not activate any tab."}t(0,n=d)}function u(){return Q}function p(){return j}let _=rn(),C,F,M=!1,j,Q=n[0];const U=bt();function oe(){j.$destroy()}function Y(d){return new d.component({target:C,anchor:F,props:d.props})}function fe(){i===!1&&a()}function v(d){r(d)}tt(()=>{j=Y(Q)}),it(()=>{j.$destroy()});const P=d=>v(d);function f(d){ye[d?"unshift":"push"](()=>{F=d,t(4,F)})}function h(d){ye[d?"unshift":"push"](()=>{C=d,t(3,C)})}return l.$$set=d=>{"tabs"in d&&t(0,n=d.tabs),"isConfig"in d&&t(1,i=d.isConfig),"caption"in d&&t(2,s=d.caption)},[n,i,s,C,F,M,Q,fe,v,a,o,r,c,u,p,P,f,h]}class Cn extends Ee{constructor(e){super(),Pe(this,e,wn,kn,_e,{tabs:0,isConfig:1,caption:2,activate:9,deactivate:10,activateTab:11,updateTabs:12,getActiveTab:13,getActiveComponent:14})}get activate(){return this.$$.ctx[9]}get deactivate(){return this.$$.ctx[10]}get activateTab(){return this.$$.ctx[11]}get updateTabs(){return this.$$.ctx[12]}get getActiveTab(){return this.$$.ctx[13]}get getActiveComponent(){return this.$$.ctx[14]}}function yn(l){let e,t,n,i;return{c(){e=$("section"),t=$("main"),n=K(),i=$("aside"),this.h()},l(s){e=B(s,"SECTION",{class:!0});var a=x(e);t=B(a,"MAIN",{class:!0});var o=x(t);o.forEach(m),n=J(a),i=B(a,"ASIDE",{class:!0,style:!0}),x(i).forEach(m),a.forEach(m),this.h()},h(){g(t,"class","flex-grow grid gap-[2px] bg-neutral-600"),ae(t,"grid-cols-1",l[4]==="single"),ae(t,"grid-rows-1",l[4]==="single"||l[4]==="dual"),ae(t,"grid-cols-2",l[4]==="dual"||l[4]==="grid"),ae(t,"grid-rows-2",l[4]==="grid"),g(i,"class","flex flex-col h-full bg-neutral-600 border-l border-neutral-900"),ft(i,"width",l[0]),ae(i,"hidden",l[3].length===0),g(e,"class","w-full h-full flex items-stretch")},m(s,a){T(s,e,a),I(e,t),l[10](t),I(e,n),I(e,i),l[11](i)},p(s,[a]){a&16&&ae(t,"grid-cols-1",s[4]==="single"),a&16&&ae(t,"grid-rows-1",s[4]==="single"||s[4]==="dual"),a&16&&ae(t,"grid-cols-2",s[4]==="dual"||s[4]==="grid"),a&16&&ae(t,"grid-rows-2",s[4]==="grid"),a&1&&ft(i,"width",s[0]),a&8&&ae(i,"hidden",s[3].length===0)},i:G,o:G,d(s){s&&m(e),l[10](null),l[11](null)}}}function En(l){switch(l){case"single":return 1;case"dual":return 2;case"grid":return 4}}function Pn(l,e,t){let{sidebarWidth:n="18rem"}=e,{defaultPanelProps:i}=e;function s(v){const f=En(v)-_.length,h=Q(_,f);(M===void 0||!h.includes(M))&&h[0].activate(),t(4,F=v),_=h}function a(v){_=[],t(5,i=v),s(F)}function o(v){const P=i.tabs.map(f=>(v.includes(f.title)?f.isDisabled=!1:f.isDisabled=!0,f));_.forEach(f=>f.updateTabs(P)),t(5,i.tabs=P,i)}function r(){return M==null?void 0:M.getActiveComponent()}const c=bt();let u,p,_=[],C=[],F="single",M;function j(v,P){const f=new Cn({target:P??u,props:v});return f.$on("activePanelChange",oe),f}function Q(v,P){let f;return P<0?(v.slice(P).forEach(d=>d.$destroy()),f=v.slice(0,P)):f=U(v,P),f}function U(v,P){const f=v.slice(0,P),h=v.map(d=>d.getActiveTab().title);for(let d=0;d<P;++d){const w=j(i),y=i.tabs.find(A=>h.includes(A.title)===!1);y&&(h.push(y.title),w.activateTab(y)),f.push(w)}return f}function oe({detail:v}){const P=v.source,f=v.configPanelsProps;if(C.forEach(h=>h.$destroy()),f){const h=[];for(let d of f){const w=j(d,p);h.push(w)}t(3,C=h)}M!=null&&M.deactivate&&M!==P&&M.deactivate(),M=P}tt(()=>{s(F)}),it(()=>{for(let v of C)v.$destroy();for(let v of _)v.$destroy();c("destroy")});function Y(v){ye[v?"unshift":"push"](()=>{u=v,t(1,u)})}function fe(v){ye[v?"unshift":"push"](()=>{p=v,t(2,p)})}return l.$$set=v=>{"sidebarWidth"in v&&t(0,n=v.sidebarWidth),"defaultPanelProps"in v&&t(5,i=v.defaultPanelProps)},[n,u,p,C,F,i,s,a,o,r,Y,fe]}class Dn extends Ee{constructor(e){super(),Pe(this,e,Pn,yn,_e,{sidebarWidth:0,defaultPanelProps:5,setView:6,setDefaultPanel:7,enableTabs:8,getActiveComponent:9})}get setView(){return this.$$.ctx[6]}get setDefaultPanel(){return this.$$.ctx[7]}get enableTabs(){return this.$$.ctx[8]}get getActiveComponent(){return this.$$.ctx[9]}}function Sn(l){let e;return{c(){e=$("ul"),this.h()},l(t){e=B(t,"UL",{class:!0}),x(e).forEach(m),this.h()},h(){g(e,"class","p-2")},m(t,n){T(t,e,n),l[3](e)},p:G,i:G,o:G,d(t){t&&m(e),l[3](null)}}}function In(l,e,t){let{fields:n}=e,{onFieldMount:i}=e,s,a={};tt(()=>{for(let r of n){const c=document.createElement("li");c.classList.add("py-1");const u=new r.component({target:c,props:r.props});s.append(c),i(r.id,u),a[r.id]=u}});function o(r){ye[r?"unshift":"push"](()=>{s=r,t(0,s)})}return l.$$set=r=>{"fields"in r&&t(1,n=r.fields),"onFieldMount"in r&&t(2,i=r.onFieldMount)},[s,n,i,o]}class Yt extends Ee{constructor(e){super(),Pe(this,e,In,Sn,_e,{fields:1,onFieldMount:2})}}function Mt(l,e,t){const n=l.slice();return n[5]=e[t],n[7]=t,n}function Tt(l){let e,t=l[5]+"",n,i;return{c(){e=$("option"),n=ne(t),this.h()},l(s){e=B(s,"OPTION",{});var a=x(e);n=se(a,t),a.forEach(m),this.h()},h(){e.__value=l[7],e.value=e.__value,e.selected=i=l[2]===l[7]},m(s,a){T(s,e,a),I(e,n)},p(s,a){a&2&&t!==(t=s[5]+"")&&Oe(n,t),a&4&&i!==(i=s[2]===s[7])&&(e.selected=i)},d(s){s&&m(e)}}}function An(l){let e,t,n,i,s,a,o,r=l[1],c=[];for(let u=0;u<r.length;u+=1)c[u]=Tt(Mt(l,r,u));return{c(){e=$("label"),t=ne(l[0]),n=ne(":"),i=K(),s=$("select");for(let u=0;u<c.length;u+=1)c[u].c();this.h()},l(u){e=B(u,"LABEL",{class:!0});var p=x(e);t=se(p,l[0]),n=se(p,":"),p.forEach(m),i=J(u),s=B(u,"SELECT",{name:!0,id:!0,class:!0});var _=x(s);for(let C=0;C<c.length;C+=1)c[C].l(_);_.forEach(m),this.h()},h(){g(e,"class","w-1/3 pr-2 text-xs text-neutral-400 text-right"),g(s,"name",l[0]),g(s,"id",l[0]),g(s,"class","emboss py-1 px-2 bg-neutral-700 border border-neutral-800 text-xs text-neutral-200")},m(u,p){T(u,e,p),I(e,t),I(e,n),T(u,i,p),T(u,s,p);for(let _=0;_<c.length;_+=1)c[_]&&c[_].m(s,null);a||(o=Ie(s,"change",l[3]),a=!0)},p(u,[p]){if(p&1&&Oe(t,u[0]),p&6){r=u[1];let _;for(_=0;_<r.length;_+=1){const C=Mt(u,r,_);c[_]?c[_].p(C,p):(c[_]=Tt(C),c[_].c(),c[_].m(s,null))}for(;_<c.length;_+=1)c[_].d(1);c.length=r.length}p&1&&g(s,"name",u[0]),p&1&&g(s,"id",u[0])},i:G,o:G,d(u){u&&m(e),u&&m(i),u&&m(s),rt(c,u),a=!1,o()}}}function Mn(l,e,t){let{name:n}=e,{options:i}=e,{selected:s=void 0}=e,{onChange:a}=e;function o(r){if(r.target){const c=r.target;a(c.value)}}return l.$$set=r=>{"name"in r&&t(0,n=r.name),"options"in r&&t(1,i=r.options),"selected"in r&&t(2,s=r.selected),"onChange"in r&&t(4,a=r.onChange)},[n,i,s,o,a]}class Tn extends Ee{constructor(e){super(),Pe(this,e,Mn,An,_e,{name:0,options:1,selected:2,onChange:4})}}function xn(l){let e;return{c(){e=$("td"),this.h()},l(t){e=B(t,"TD",{class:!0});var n=x(e);n.forEach(m),this.h()},h(){g(e,"class","py-1 px-2 border-l border-neutral-800 text-neutral-100 text-xs")},m(t,n){T(t,e,n),e.innerHTML=l[0]},p(t,[n]){n&1&&(e.innerHTML=t[0])},i:G,o:G,d(t){t&&m(e)}}}function Fn(l,e,t){let{value:n}=e,{formatter:i=void 0}=e,s;if(i)s=i(n);else if(typeof n=="string")s=n;else if(n.toString)s=n.toString();else throw"Error: Cannot format value.";return l.$$set=a=>{"value"in a&&t(1,n=a.value),"formatter"in a&&t(2,i=a.formatter)},[s,n,i]}class Rn extends Ee{constructor(e){super(),Pe(this,e,Fn,xn,_e,{value:1,formatter:2})}}function xt(l,e,t){const n=l.slice();return n[3]=e[t],n}function Ft(l){let e,t;const n=[l[3]];let i={};for(let s=0;s<n.length;s+=1)i=Ge(i,n[s]);return e=new Rn({props:i}),{c(){be(e.$$.fragment)},l(s){ve(e.$$.fragment,s)},m(s,a){ke(e,s,a),t=!0},p(s,a){const o=a&1?Gt(n,[qt(s[3])]):{};e.$set(o)},i(s){t||(V(e.$$.fragment,s),t=!0)},o(s){H(e.$$.fragment,s),t=!1},d(s){we(e,s)}}}function Ln(l){let e,t,n,i,s=l[0],a=[];for(let r=0;r<s.length;r+=1)a[r]=Ft(xt(l,s,r));const o=r=>H(a[r],1,1,()=>{a[r]=null});return{c(){e=$("tr");for(let r=0;r<a.length;r+=1)a[r].c();this.h()},l(r){e=B(r,"TR",{class:!0});var c=x(e);for(let u=0;u<a.length;u+=1)a[u].l(c);c.forEach(m),this.h()},h(){g(e,"class","hover:bg-neutral-600 border-b last:border-b-0 border-neutral-800")},m(r,c){T(r,e,c);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(e,null);t=!0,n||(i=[Ie(e,"mouseenter",l[1]),Ie(e,"mouseleave",l[2])],n=!0)},p(r,[c]){if(c&1){s=r[0];let u;for(u=0;u<s.length;u+=1){const p=xt(r,s,u);a[u]?(a[u].p(p,c),V(a[u],1)):(a[u]=Ft(p),a[u].c(),V(a[u],1),a[u].m(e,null))}for(Ve(),u=s.length;u<a.length;u+=1)o(u);Ne()}},i(r){if(!t){for(let c=0;c<s.length;c+=1)V(a[c]);t=!0}},o(r){a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)H(a[c]);t=!1},d(r){r&&m(e),rt(a,r),n=!1,dt(i)}}}function On(l,e,t){let{cells:n}=e;function i(a){ut.call(this,l,a)}function s(a){ut.call(this,l,a)}return l.$$set=a=>{"cells"in a&&t(0,n=a.cells)},[n,i,s]}class $n extends Ee{constructor(e){super(),Pe(this,e,On,Ln,_e,{cells:0})}}function Rt(l,e,t){const n=l.slice();return n[9]=e[t],n[11]=t,n}function Lt(l,e,t){const n=l.slice();return n[12]=e[t],n}function Ot(l){let e,t,n=l[1],i=[];for(let s=0;s<n.length;s+=1)i[s]=$t(Lt(l,n,s));return{c(){e=$("thead"),t=$("tr");for(let s=0;s<i.length;s+=1)i[s].c();this.h()},l(s){e=B(s,"THEAD",{});var a=x(e);t=B(a,"TR",{class:!0});var o=x(t);for(let r=0;r<i.length;r+=1)i[r].l(o);o.forEach(m),a.forEach(m),this.h()},h(){g(t,"class","bg-gradient-to-t from-neutral-600 to-neutral-500 border-b border-neutral-800")},m(s,a){T(s,e,a),I(e,t);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(t,null)},p(s,a){if(a&2){n=s[1];let o;for(o=0;o<n.length;o+=1){const r=Lt(s,n,o);i[o]?i[o].p(r,a):(i[o]=$t(r),i[o].c(),i[o].m(t,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}},d(s){s&&m(e),rt(i,s)}}}function $t(l){let e,t=l[12]+"",n;return{c(){e=$("th"),n=ne(t),this.h()},l(i){e=B(i,"TH",{class:!0});var s=x(e);n=se(s,t),s.forEach(m),this.h()},h(){g(e,"class","px-2 border-l border-neutral-800 text-neutral-300 text-[0.6875rem] font-medium lowercase small-caps svelte-2meyxc")},m(i,s){T(i,e,s),I(e,n)},p(i,s){s&2&&t!==(t=i[12]+"")&&Oe(n,t)},d(i){i&&m(e)}}}function Bt(l){let e,t;const n=[l[9]];function i(){return l[6](l[11])}function s(){return l[7](l[11])}let a={};for(let o=0;o<n.length;o+=1)a=Ge(a,n[o]);return e=new $n({props:a}),e.$on("mouseenter",i),e.$on("mouseleave",s),{c(){be(e.$$.fragment)},l(o){ve(e.$$.fragment,o)},m(o,r){ke(e,o,r),t=!0},p(o,r){l=o;const c=r&4?Gt(n,[qt(l[9])]):{};e.$set(c)},i(o){t||(V(e.$$.fragment,o),t=!0)},o(o){H(e.$$.fragment,o),t=!1},d(o){we(e,o)}}}function zt(l){let e,t,n=l[2],i=[];for(let a=0;a<n.length;a+=1)i[a]=Bt(Rt(l,n,a));const s=a=>H(i[a],1,1,()=>{i[a]=null});return{c(){for(let a=0;a<i.length;a+=1)i[a].c();e=$e()},l(a){for(let o=0;o<i.length;o+=1)i[o].l(a);e=$e()},m(a,o){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(a,o);T(a,e,o),t=!0},p(a,o){if(o&52){n=a[2];let r;for(r=0;r<n.length;r+=1){const c=Rt(a,n,r);i[r]?(i[r].p(c,o),V(i[r],1)):(i[r]=Bt(c),i[r].c(),V(i[r],1),i[r].m(e.parentNode,e))}for(Ve(),r=n.length;r<i.length;r+=1)s(r);Ne()}},i(a){if(!t){for(let o=0;o<n.length;o+=1)V(i[o]);t=!0}},o(a){i=i.filter(Boolean);for(let o=0;o<i.length;o+=1)H(i[o]);t=!1},d(a){rt(i,a),a&&m(e)}}}function Bn(l){let e,t,n,i,s,a,o=l[2],r,c=l[3]&&Ot(l),u=zt(l);return{c(){e=$("label"),t=ne(l[0]),n=K(),i=$("table"),c&&c.c(),s=K(),a=$("tbody"),u.c(),this.h()},l(p){e=B(p,"LABEL",{class:!0});var _=x(e);t=se(_,l[0]),_.forEach(m),n=J(p),i=B(p,"TABLE",{class:!0});var C=x(i);c&&c.l(C),s=J(C),a=B(C,"TBODY",{});var F=x(a);u.l(F),F.forEach(m),C.forEach(m),this.h()},h(){g(e,"class","w-1/3 pr-2 text-xs text-neutral-400 text-right"),g(i,"class","table-shadow w-full my-1 bg-neutral-700 border border-neutral-800 svelte-2meyxc")},m(p,_){T(p,e,_),I(e,t),T(p,n,_),T(p,i,_),c&&c.m(i,null),I(i,s),I(i,a),u.m(a,null),r=!0},p(p,[_]){(!r||_&1)&&Oe(t,p[0]),p[3]?c?c.p(p,_):(c=Ot(p),c.c(),c.m(i,s)):c&&(c.d(1),c=null),_&4&&_e(o,o=p[2])?(Ve(),H(u,1,1,G),Ne(),u=zt(p),u.c(),V(u,1),u.m(a,null)):u.p(p,_)},i(p){r||(V(u),r=!0)},o(p){H(u),r=!1},d(p){p&&m(e),p&&m(n),p&&m(i),c&&c.d(),u.d(p)}}}function zn(l,e,t){let{name:n}=e,{columns:i}=e,{rows:s}=e,{showColumns:a=!0}=e;const o=bt();function r(_){o("rowHover",_)}function c(_){o("rowLeave",_)}const u=_=>r(_),p=_=>c(_);return l.$$set=_=>{"name"in _&&t(0,n=_.name),"columns"in _&&t(1,i=_.columns),"rows"in _&&t(2,s=_.rows),"showColumns"in _&&t(3,a=_.showColumns)},[n,i,s,a,r,c,u,p]}class Vn extends Ee{constructor(e){super(),Pe(this,e,zn,Bn,_e,{name:0,columns:1,rows:2,showColumns:3})}}function Nn(l){let e,t,n,i,s,a;return{c(){e=$("label"),t=ne(l[0]),n=ne(":"),i=K(),s=$("span"),a=ne(l[1]),this.h()},l(o){e=B(o,"LABEL",{class:!0});var r=x(e);t=se(r,l[0]),n=se(r,":"),r.forEach(m),i=J(o),s=B(o,"SPAN",{class:!0});var c=x(s);a=se(c,l[1]),c.forEach(m),this.h()},h(){g(e,"class","text-xs text-neutral-400 text-right"),g(s,"class","text-xs text-neutral-200")},m(o,r){T(o,e,r),I(e,t),I(e,n),T(o,i,r),T(o,s,r),I(s,a)},p(o,[r]){r&1&&Oe(t,o[0]),r&2&&Oe(a,o[1])},i:G,o:G,d(o){o&&m(e),o&&m(i),o&&m(s)}}}function jn(l,e,t){let{name:n}=e,{label:i}=e;return l.$$set=s=>{"name"in s&&t(0,n=s.name),"label"in s&&t(1,i=s.label)},[n,i]}class ct extends Ee{constructor(e){super(),Pe(this,e,jn,Nn,_e,{name:0,label:1})}}function Hn(l){let e,t,n,i,s,a,o,r;return{c(){e=$("div"),t=$("img"),i=K(),s=$("canvas"),this.h()},l(c){e=B(c,"DIV",{class:!0});var u=x(e);t=B(u,"IMG",{src:!0,class:!0}),i=J(u),s=B(u,"CANVAS",{class:!0}),x(s).forEach(m),u.forEach(m),this.h()},h(){an(t.src,n=l[2])||g(t,"src",n),g(t,"class","absolute left-1/2 -translate-x-1/2 h-full object-contain"),g(s,"class","z-10 absolute left-1/2 -translate-x-1/2 h-full"),g(e,"class",a=(l[4].class??"")+" relative w-full h-full bg-white")},m(c,u){T(c,e,u),I(e,t),l[9](t),I(e,i),I(e,s),l[10](s),o||(r=Ie(t,"load",l[3]),o=!0)},p(c,u){u[0]&16&&a!==(a=(c[4].class??"")+" relative w-full h-full bg-white")&&g(e,"class",a)},i:G,o:G,d(c){c&&m(e),l[9](null),l[10](null),o=!1,r()}}}function Un(l,e,t){const n={},i={};let s=0,a=0,o=0,r=0;l.forEach((C,F)=>{var M,j;n[M=C.valence]||(n[M]=0),n[C.valence]+=e[F],i[j=C.intensity]||(i[j]=0),i[C.intensity]+=e[F]}),Object.keys(n).map(C=>{let F=(t-n[C])/t;F===0&&(F=1),o+=F*parseInt(C),s+=F}),Object.keys(i).map(C=>{let F=(t-i[C])/t;F===0&&(F=1),r+=F*parseInt(C),a+=F});const c=s?o/s:0,u=a?r/a:0,p=Math.round(c*100)/100,_=Math.round(u*100)/100;return{avgValence:p,avgIntensity:_}}function Wn(l,e,t){const n=l.getImageData(0,0,e,t).data;let i=0;for(let s=3,a=n.length;s<a;s+=4)n[s]>0&&++i;return i}function Gn(l,e,t){let{persona:n}=e,{participantsDrawings:i}=e;function s(){return f}function a(){const E=`Participant-${M+1}-${n}`,z=r.toDataURL("image/png");return{name:E,data:z}}let o,r,c,u=0,p=0,_=1,C=vt[n],F,M=ln(lt.selectedParticipantIdx)??0,j=i[M],Q={name:"Strokes",columns:[],rows:[]},U=[],oe=0,Y=0,fe=0,v={},P={onFieldMount:h,fields:[{id:"participant",component:Tn,props:{name:"Participant",options:i.map((k,E)=>`Participant #${E+1}`),selected:M,onChange:b}},{id:"strokes",component:Vn,props:Q},{id:"totalDrawnArea",component:ct,props:{name:"Drawing size",label:`${oe} pixels`}},{id:"avgValence",component:ct,props:{name:"Avg valence",label:Y}},{id:"avgIntensity",component:ct,props:{name:"Avg intensity",label:fe}}]},f=[{isConfig:!0,tabs:[{title:"Settings",defaultActive:!0,component:Yt,props:P}]}];function h(k,E){if(v[k]=E,k==="strokes"){const z=L(j);v.strokes.$set(z),v.strokes.$on("rowHover",R),v.strokes.$on("rowLeave",he)}v.totalDrawnArea&&v.totalDrawnArea.$set({label:`${oe} pixels`}),v.avgValence&&v.avgValence.$set({label:Y}),v.avgIntensity&&v.avgIntensity.$set({label:fe})}function d(){const k=r.getContext("2d");if(k==null){et(`Error: Could not get context of canvas for ${n}.`);return}c=k}function w(){F.classList.remove("hidden");const k=F.getBoundingClientRect();y(k.width,k.height),A(k.width,k.height),u=k.width,p=k.height,_=k.width/F.width,W(j)}function y(k,E){const z=window.devicePixelRatio||1;t(0,r.width=k*z,r),t(0,r.height=E*z,r),c.scale(z,z)}function A(k,E){F.classList.remove("hidden"),c.drawImage(F,0,0,k,E),c.globalCompositeOperation="source-atop",F.classList.add("hidden")}function L(k){const E={name:"Strokes",columns:["Valence","Intensity","Color","Size"],rows:[]};return k.forEach((z,ie)=>{E.rows.push({cells:[{value:z.valence},{value:z.intensity},{value:z.brushColor,formatter:ee=>`<span class="block w-full h-3" style="background-color: ${ee};"></span>`},{value:ie<U.length?U[ie]:""}]})}),E}function Z(k){const E=[];let z=0;for(let ie of k){const ee=X(ie);E.push(ee),z+=ee}return{totalArea:z,areas:E}}function W(k){Ye(k,c,_);const E=Z(k),z=Un(k,E.areas,E.totalArea);oe=E.totalArea,U=E.areas,Y=z.avgValence,fe=z.avgIntensity,j=k,Q=L(k),v.strokes&&v.strokes.$set(Q),v.totalDrawnArea&&v.totalDrawnArea.$set({label:`${oe} pixels`}),v.avgValence&&v.avgValence.$set({label:Y}),v.avgIntensity&&v.avgIntensity.$set({label:fe})}function b(k){const E=parseInt(k),z=i[E];A(u,p),W(z),lt.selectedParticipantIdx.set(E),M=E}function N(){r.getBoundingClientRect()}function R({detail:k}){const E=[j[k]];A(u,p),Ye(E,c,_)}function he(){A(u,p),Ye(j,c,_)}function X(k){const E=document.createElement("canvas"),z=E.getContext("2d");if(z==null)throw"Error: Could not get canvas context while getting drawn pixels.";return E.width=u,E.height=p,Ye([k],z,_),Wn(z,u,p)}tt(()=>{if(C==null){et(`Error: Persona SVG path of ${n} was not found.`);return}d(),o=new ResizeObserver(N),o.observe(r)}),it(()=>{r&&o.unobserve(r)});function S(k){ye[k?"unshift":"push"](()=>{F=k,t(1,F)})}function D(k){ye[k?"unshift":"push"](()=>{r=k,t(0,r)})}return l.$$set=k=>{t(4,e=Ge(Ge({},e),Xe(k))),"persona"in k&&t(5,n=k.persona),"participantsDrawings"in k&&t(6,i=k.participantsDrawings)},e=Xe(e),[r,F,C,w,e,n,i,s,a,S,D]}class qn extends Ee{constructor(e){super(),Pe(this,e,Gn,Hn,_e,{persona:5,participantsDrawings:6,getConfigPanelsProps:7,getImage:8},null,[-1,-1])}get persona(){return this.$$.ctx[5]}set persona(e){this.$$set({persona:e}),We()}get participantsDrawings(){return this.$$.ctx[6]}set participantsDrawings(e){this.$$set({participantsDrawings:e}),We()}get getConfigPanelsProps(){return this.$$.ctx[7]}get getImage(){return this.$$.ctx[8]}}class Zt{constructor(e,t,n,i,s){Qe(this,"xDomain");Qe(this,"yDomain");Qe(this,"binWidth",1);Qe(this,"binHeight",1);Qe(this,"_bins",{});this.xDomain=t,this.yDomain=n,this.binWidth=i??this.binWidth,this.binHeight=s??this.binHeight,this.makeBins(),this.binPoints(e)}makeBins(){for(let e=this.xDomain[0],t=this.xDomain[1];e<t;e+=this.binWidth)for(let n=this.yDomain[0],i=this.yDomain[1];n<i;n+=this.binHeight){const s=Math.floor(e/this.binWidth),a=Math.floor(n/this.binHeight),o=s+"-"+a,r=s*this.binWidth,c=a*this.binHeight;this._bins[o]=Object.assign(new Array,{nx:s,ny:a,x:r,y:c})}}binPoints(e){for(let t of e){const n=Math.floor(t.x/this.binWidth),i=Math.floor(t.y/this.binHeight),s=n+"-"+i,a=this._bins[s];if(a===void 0)throw`Error: Could not find bin for point ${t}`;a.push(t)}}get bins(){return Object.values(this._bins).filter(e=>e.length>0)}}function Kn(l){let e,t,n,i,s,a,o,r;return{c(){e=$("div"),t=$("label"),n=ne(l[1]),i=ne(":"),s=K(),a=$("input"),this.h()},l(c){e=B(c,"DIV",{class:!0});var u=x(e);t=B(u,"LABEL",{class:!0});var p=x(t);n=se(p,l[1]),i=se(p,":"),p.forEach(m),s=J(u),a=B(u,"INPUT",{type:!0,name:!0,id:!0,class:!0}),u.forEach(m),this.h()},h(){g(t,"class","pr-2 text-xs text-neutral-400 text-right"),g(a,"type","color"),g(a,"name",l[1]),g(a,"id",l[1]),g(a,"class","emboss py-1 px-2 bg-neutral-700 border border-neutral-800 text-xs text-neutral-200"),g(e,"class","flex items-center")},m(c,u){T(c,e,u),I(e,t),I(t,n),I(t,i),I(e,s),I(e,a),Ct(a,l[0]),o||(r=[Ie(a,"input",l[2]),Ie(a,"input",l[4])],o=!0)},p(c,[u]){u&2&&Oe(n,c[1]),u&2&&g(a,"name",c[1]),u&2&&g(a,"id",c[1]),u&1&&Ct(a,c[0])},i:G,o:G,d(c){c&&m(e),o=!1,dt(r)}}}function Jn(l,e,t){let{name:n}=e,{value:i="#0000FF"}=e,{onChange:s}=e;function a(r){if(r.target){const c=r.target;s(c.value)}}function o(){i=this.value,t(0,i)}return l.$$set=r=>{"name"in r&&t(1,n=r.name),"value"in r&&t(0,i=r.value),"onChange"in r&&t(3,s=r.onChange)},[i,n,a,s,o]}class Qn extends Ee{constructor(e){super(),Pe(this,e,Jn,Kn,_e,{name:1,value:0,onChange:3})}}function Vt(l){let e,t,n,i,s;return{c(){e=$("span"),t=De("svg"),n=De("circle"),i=De("path"),s=ne(`
      Processing...`),this.h()},l(a){e=B(a,"SPAN",{class:!0,disabled:!0});var o=x(e);t=Se(o,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var r=x(t);n=Se(r,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),x(n).forEach(m),i=Se(r,"path",{class:!0,fill:!0,d:!0}),x(i).forEach(m),r.forEach(m),s=se(o,`
      Processing...`),o.forEach(m),this.h()},h(){g(n,"class","opacity-25"),g(n,"cx","12"),g(n,"cy","12"),g(n,"r","10"),g(n,"stroke","currentColor"),g(n,"stroke-width","4"),g(i,"class","opacity-75"),g(i,"fill","currentColor"),g(i,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),g(t,"class","animate-spin -ml-1 mr-3 h-5 w-5 text-neutral-500"),g(t,"xmlns","http://www.w3.org/2000/svg"),g(t,"fill","none"),g(t,"viewBox","0 0 24 24"),g(e,"class","z-20 absolute top-0 left-0 flex items-center justify-center w-full h-full bg-white font-semibold text-sm text-neutral-600"),g(e,"disabled","")},m(a,o){T(a,e,o),I(e,t),I(t,n),I(t,i),I(e,s)},d(a){a&&m(e)}}}function Yn(l){let e,t,n,i,s,a,o=l[2]&&Vt();return{c(){e=$("div"),o&&o.c(),t=K(),n=$("img"),i=K(),s=$("canvas"),this.h()},l(r){e=B(r,"DIV",{class:!0});var c=x(e);o&&o.l(c),t=J(c),n=B(c,"IMG",{class:!0}),i=J(c),s=B(c,"CANVAS",{class:!0}),x(s).forEach(m),c.forEach(m),this.h()},h(){g(n,"class","absolute left-1/2 -translate-x-1/2 h-full object-contain"),g(s,"class","z-10 absolute left-1/2 -translate-x-1/2 h-full"),g(e,"class",a=(l[3].class??"")+" relative w-full h-full bg-white")},m(r,c){T(r,e,c),o&&o.m(e,null),I(e,t),I(e,n),l[9](n),I(e,i),I(e,s),l[10](s)},p(r,[c]){r[2]?o||(o=Vt(),o.c(),o.m(e,t)):o&&(o.d(1),o=null),c&8&&a!==(a=(r[3].class??"")+" relative w-full h-full bg-white")&&g(e,"class",a)},i:G,o:G,d(r){r&&m(e),o&&o.d(),l[9](null),l[10](null)}}}function Zn(l,e,t){const n=[],i=l.getImageData(0,0,e,t).data;for(let s=3,a=i.length;s<a;s+=4)if(i[s]>0){const o=Math.floor(s/4)%e,r=Math.floor(s/4/e);n.push({x:o,y:r})}return n}function Xn(l,e,t){let{persona:n}=e,{participantsStrokes:i}=e,{totalParticipants:s}=e;function a(){return v}function o(){const b=`DensityMap-${n}`,N=c.toDataURL("image/png");return{name:b,data:N}}let r,c,u,p=0,_=0,C=1,F=vt[n],M,j,Q,U,oe=!0;Ze.mapColors[n].subscribe(b=>{j=nt(b).hex(),Q=nt.scale([nt("#b5b5b5"),nt(b)])});let Y={},v=[{isConfig:!0,tabs:[{title:"Settings",defaultActive:!0,component:Yt,props:{onFieldMount:P,fields:[{id:"mapColor",component:Qn,props:{name:"Map color",onChange:L}}]}}]}];function P(b,N){Y[b]=N,b==="mapColor"&&Y.mapColor.$set({value:j})}function f(){const b=c.getContext("2d");if(b==null){et(`Error: Could not get context of canvas for ${n}.`);return}u=b}function h(){if(M==null)return;const b=M.getBoundingClientRect();Kt(b.width,b.height,c,u),d(b.width,b.height),p=Math.floor(b.width),_=Math.floor(b.height),C=b.width/M.width;const N=y(i),R=new Zt(N,[0,p],[0,_]);w(R,s),U=R,t(2,oe=!1)}function d(b,N){M.classList.remove("hidden"),Jt(M,u,b,N,!0),M.classList.add("hidden")}function w(b,N){const R=b.bins,he=Q.domain([0,N]);for(let X of R)u.fillStyle=he(X.length).hex(),u.fillRect(X.x,X.y,b.binWidth,b.binHeight)}function y(b){let N=[];for(let R of b){const he=document.createElement("canvas"),X=he.getContext("2d");if(X==null)throw"Error: Could not get canvas context while getting drawn pixels.";he.width=p,he.height=_,Ye(R,X,C);const S=Zn(X,p,_);N=N.concat(S)}return N}function A(){c.getBoundingClientRect()}function L(b){j=b,Ze.mapColors[n].set(b),t(2,oe=!0),w(U,s),t(2,oe=!1)}tt(()=>{if(F==null){et(`Error: Persona SVG path of ${n} was not found.`);return}f(),t(1,M.onload=h,M),t(1,M.src=F,M),r=new ResizeObserver(A),r.observe(c)}),it(()=>{c&&r.unobserve(c)});function Z(b){ye[b?"unshift":"push"](()=>{M=b,t(1,M)})}function W(b){ye[b?"unshift":"push"](()=>{c=b,t(0,c)})}return l.$$set=b=>{t(3,e=Ge(Ge({},e),Xe(b))),"persona"in b&&t(4,n=b.persona),"participantsStrokes"in b&&t(5,i=b.participantsStrokes),"totalParticipants"in b&&t(6,s=b.totalParticipants)},e=Xe(e),[c,M,oe,e,n,i,s,a,o,Z,W]}class es extends Ee{constructor(e){super(),Pe(this,e,Xn,Yn,_e,{persona:4,participantsStrokes:5,totalParticipants:6,getConfigPanelsProps:7,getImage:8})}get persona(){return this.$$.ctx[4]}set persona(e){this.$$set({persona:e}),We()}get participantsStrokes(){return this.$$.ctx[5]}set participantsStrokes(e){this.$$set({participantsStrokes:e}),We()}get totalParticipants(){return this.$$.ctx[6]}set totalParticipants(e){this.$$set({totalParticipants:e}),We()}get getConfigPanelsProps(){return this.$$.ctx[7]}get getImage(){return this.$$.ctx[8]}}function Nt(l){let e,t,n,i,s;return{c(){e=$("span"),t=De("svg"),n=De("circle"),i=De("path"),s=ne(`
      Processing...`),this.h()},l(a){e=B(a,"SPAN",{class:!0,disabled:!0});var o=x(e);t=Se(o,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var r=x(t);n=Se(r,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),x(n).forEach(m),i=Se(r,"path",{class:!0,fill:!0,d:!0}),x(i).forEach(m),r.forEach(m),s=se(o,`
      Processing...`),o.forEach(m),this.h()},h(){g(n,"class","opacity-25"),g(n,"cx","12"),g(n,"cy","12"),g(n,"r","10"),g(n,"stroke","currentColor"),g(n,"stroke-width","4"),g(i,"class","opacity-75"),g(i,"fill","currentColor"),g(i,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),g(t,"class","animate-spin -ml-1 mr-3 h-5 w-5 text-neutral-500"),g(t,"xmlns","http://www.w3.org/2000/svg"),g(t,"fill","none"),g(t,"viewBox","0 0 24 24"),g(e,"class","z-20 absolute top-0 left-0 flex items-center justify-center w-full h-full bg-white font-semibold text-sm text-neutral-600"),g(e,"disabled","")},m(a,o){T(a,e,o),I(e,t),I(t,n),I(t,i),I(e,s)},d(a){a&&m(e)}}}function ts(l){let e,t,n,i,s,a,o=l[2]&&Nt();return{c(){e=$("div"),o&&o.c(),t=K(),n=$("img"),i=K(),s=$("canvas"),this.h()},l(r){e=B(r,"DIV",{class:!0});var c=x(e);o&&o.l(c),t=J(c),n=B(c,"IMG",{class:!0}),i=J(c),s=B(c,"CANVAS",{class:!0}),x(s).forEach(m),c.forEach(m),this.h()},h(){g(n,"class","absolute left-1/2 -translate-x-1/2 h-full object-contain"),g(s,"class","z-10 absolute left-1/2 -translate-x-1/2 h-full"),g(e,"class",a=(l[3].class??"")+" relative w-full h-full bg-white")},m(r,c){T(r,e,c),o&&o.m(e,null),I(e,t),I(e,n),l[9](n),I(e,i),I(e,s),l[10](s)},p(r,[c]){r[2]?o||(o=Nt(),o.c(),o.m(e,t)):o&&(o.d(1),o=null),c&8&&a!==(a=(r[3].class??"")+" relative w-full h-full bg-white")&&g(e,"class",a)},i:G,o:G,d(r){r&&m(e),o&&o.d(),l[9](null),l[10](null)}}}function ns(l,e,t,n){const i=[],s=l.getImageData(0,0,e,t).data;for(let a=3,o=s.length;a<o;a+=4)if(s[a]>0){const r=Math.floor(a/4)%e,c=Math.floor(a/4/e);i.push({x:r,y:c,measure:n})}return i}function ss(l,e,t){let{persona:n}=e,{participantsStrokes:i}=e,{totalParticipants:s}=e;function a(){return Q}function o(){const d=`ValenceMap-${n}`,w=c.toDataURL("image/png");return{name:d,data:w}}let r,c,u,p=0,_=0,C=1,F=vt[n],M,j=!0,Q=[];function U(){const d=c.getContext("2d");if(d==null){et(`Error: Could not get context of canvas for ${n}.`);return}u=d}function oe(){if(M==null)return;const d=M.getBoundingClientRect();Kt(d.width,d.height,c,u),Y(d.width,d.height),p=Math.floor(d.width),_=Math.floor(d.height),C=d.width/M.width;const w=v(i),y=new Zt(w,[0,p],[0,_]);fe(y),t(2,j=!1)}function Y(d,w){M.classList.remove("hidden"),Jt(M,u,d,w,!0),M.classList.add("hidden")}function fe(d){const w=d.bins,A=nt.scale(["red","green"]).domain([-50,50]);for(let L of w){const W=L.map(b=>b.measure).reduce((b,N)=>b+N,0)/L.length;u.fillStyle=A(W).hex(),u.fillRect(L.x,L.y,d.binWidth,d.binHeight)}}function v(d){let w=[];for(let y of d){const A=document.createElement("canvas"),L=A.getContext("2d");if(L==null)throw"Error: Could not get canvas context while getting drawn pixels.";A.width=p,A.height=_;for(let Z of y){const W=Z.intensity*Z.valence;Ye([Z],L,C);const b=ns(L,p,_,W);w=w.concat(b),L.clearRect(0,0,p,_)}}return w}function P(){c.getBoundingClientRect()}tt(()=>{if(F==null){et(`Error: Persona SVG path of ${n} was not found.`);return}U(),t(1,M.onload=oe,M),t(1,M.src=F,M),r=new ResizeObserver(P),r.observe(c)}),it(()=>{c&&r.unobserve(c)});function f(d){ye[d?"unshift":"push"](()=>{M=d,t(1,M)})}function h(d){ye[d?"unshift":"push"](()=>{c=d,t(0,c)})}return l.$$set=d=>{t(3,e=Ge(Ge({},e),Xe(d))),"persona"in d&&t(4,n=d.persona),"participantsStrokes"in d&&t(5,i=d.participantsStrokes),"totalParticipants"in d&&t(6,s=d.totalParticipants)},e=Xe(e),[c,M,j,e,n,i,s,a,o,f,h]}class is extends Ee{constructor(e){super(),Pe(this,e,ss,ts,_e,{persona:4,participantsStrokes:5,totalParticipants:6,getConfigPanelsProps:7,getImage:8})}get persona(){return this.$$.ctx[4]}set persona(e){this.$$set({persona:e}),We()}get participantsStrokes(){return this.$$.ctx[5]}set participantsStrokes(e){this.$$set({participantsStrokes:e}),We()}get totalParticipants(){return this.$$.ctx[6]}set totalParticipants(e){this.$$set({totalParticipants:e}),We()}get getConfigPanelsProps(){return this.$$.ctx[7]}get getImage(){return this.$$.ctx[8]}}function rs(l){let e;return{c(){e=ne("Load Survey Data")},l(t){e=se(t,"Load Survey Data")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function jt(l){let e,t,n,i,s,a,o,r;return e=new Le({props:{$$slots:{default:[as]},$$scope:{ctx:l}}}),e.$on("click",l[12]),n=new Le({props:{$$slots:{default:[ls]},$$scope:{ctx:l}}}),n.$on("click",l[13]),s=new vn({}),o=new Le({props:{$$slots:{default:[os]},$$scope:{ctx:l}}}),o.$on("click",l[8]),{c(){be(e.$$.fragment),t=K(),be(n.$$.fragment),i=K(),be(s.$$.fragment),a=K(),be(o.$$.fragment)},l(c){ve(e.$$.fragment,c),t=J(c),ve(n.$$.fragment,c),i=J(c),ve(s.$$.fragment,c),a=J(c),ve(o.$$.fragment,c)},m(c,u){ke(e,c,u),T(c,t,u),ke(n,c,u),T(c,i,u),ke(s,c,u),T(c,a,u),ke(o,c,u),r=!0},p(c,u){const p={};u[1]&64&&(p.$$scope={dirty:u,ctx:c}),e.$set(p);const _={};u[1]&64&&(_.$$scope={dirty:u,ctx:c}),n.$set(_);const C={};u[1]&64&&(C.$$scope={dirty:u,ctx:c}),o.$set(C)},i(c){r||(V(e.$$.fragment,c),V(n.$$.fragment,c),V(s.$$.fragment,c),V(o.$$.fragment,c),r=!0)},o(c){H(e.$$.fragment,c),H(n.$$.fragment,c),H(s.$$.fragment,c),H(o.$$.fragment,c),r=!1},d(c){we(e,c),c&&m(t),we(n,c),c&&m(i),we(s,c),c&&m(a),we(o,c)}}}function as(l){let e;return{c(){e=ne("Export image")},l(t){e=se(t,"Export image")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function ls(l){let e;return{c(){e=ne("Export data (CSV)")},l(t){e=se(t,"Export data (CSV)")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function os(l){let e;return{c(){e=ne("Close project")},l(t){e=se(t,"Close project")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function cs(l){let e,t,n,i;e=new Le({props:{$$slots:{default:[rs]},$$scope:{ctx:l}}}),e.$on("click",l[7]);let s=l[3]&&jt(l);return{c(){be(e.$$.fragment),t=K(),s&&s.c(),n=$e()},l(a){ve(e.$$.fragment,a),t=J(a),s&&s.l(a),n=$e()},m(a,o){ke(e,a,o),T(a,t,o),s&&s.m(a,o),T(a,n,o),i=!0},p(a,o){const r={};o[1]&64&&(r.$$scope={dirty:o,ctx:a}),e.$set(r),a[3]?s?(s.p(a,o),o[0]&8&&V(s,1)):(s=jt(a),s.c(),V(s,1),s.m(n.parentNode,n)):s&&(Ve(),H(s,1,1,()=>{s=null}),Ne())},i(a){i||(V(e.$$.fragment,a),V(s),i=!0)},o(a){H(e.$$.fragment,a),H(s),i=!1},d(a){we(e,a),a&&m(t),s&&s.d(a),a&&m(n)}}}function Ht(l){let e,t,n,i,s={title:"View",$$slots:{default:[ds]},$$scope:{ctx:l}};e=new ht({props:s}),l[18](e);let a={title:"Tools",enableIcon:!0,$$slots:{default:[ks]},$$scope:{ctx:l}};return n=new ht({props:a}),l[22](n),{c(){be(e.$$.fragment),t=K(),be(n.$$.fragment)},l(o){ve(e.$$.fragment,o),t=J(o),ve(n.$$.fragment,o)},m(o,r){ke(e,o,r),T(o,t,r),ke(n,o,r),i=!0},p(o,r){const c={};r[0]&2|r[1]&64&&(c.$$scope={dirty:r,ctx:o}),e.$set(c);const u={};r[0]&2|r[1]&64&&(u.$$scope={dirty:r,ctx:o}),n.$set(u)},i(o){i||(V(e.$$.fragment,o),V(n.$$.fragment,o),i=!0)},o(o){H(e.$$.fragment,o),H(n.$$.fragment,o),i=!1},d(o){l[18](null),we(e,o),o&&m(t),l[22](null),we(n,o)}}}function us(l){let e;return{c(){e=ne("Single")},l(t){e=se(t,"Single")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function fs(l){let e;return{c(){e=ne("Side by side")},l(t){e=se(t,"Side by side")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function Ut(l){let e,t;return e=new Le({props:{$$slots:{default:[hs]},$$scope:{ctx:l}}}),e.$on("click",l[17]),{c(){be(e.$$.fragment)},l(n){ve(e.$$.fragment,n)},m(n,i){ke(e,n,i),t=!0},p(n,i){const s={};i[1]&64&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){t||(V(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){we(e,n)}}}function hs(l){let e;return{c(){e=ne("Grid")},l(t){e=se(t,"Grid")},m(t,n){T(t,e,n)},d(t){t&&m(e)}}}function ds(l){let e,t,n,i,s,a;e=new Le({props:{$$slots:{default:[us]},$$scope:{ctx:l}}}),e.$on("click",l[15]),n=new Le({props:{$$slots:{default:[fs]},$$scope:{ctx:l}}}),n.$on("click",l[16]);let o=l[1]!==me.LookingGlass&&Ut(l);return{c(){be(e.$$.fragment),t=K(),be(n.$$.fragment),i=K(),o&&o.c(),s=$e()},l(r){ve(e.$$.fragment,r),t=J(r),ve(n.$$.fragment,r),i=J(r),o&&o.l(r),s=$e()},m(r,c){ke(e,r,c),T(r,t,c),ke(n,r,c),T(r,i,c),o&&o.m(r,c),T(r,s,c),a=!0},p(r,c){const u={};c[1]&64&&(u.$$scope={dirty:c,ctx:r}),e.$set(u);const p={};c[1]&64&&(p.$$scope={dirty:c,ctx:r}),n.$set(p),r[1]!==me.LookingGlass?o?(o.p(r,c),c[0]&2&&V(o,1)):(o=Ut(r),o.c(),V(o,1),o.m(s.parentNode,s)):o&&(Ve(),H(o,1,1,()=>{o=null}),Ne())},i(r){a||(V(e.$$.fragment,r),V(n.$$.fragment,r),V(o),a=!0)},o(r){H(e.$$.fragment,r),H(n.$$.fragment,r),H(o),a=!1},d(r){we(e,r),r&&m(t),we(n,r),r&&m(i),o&&o.d(r),r&&m(s)}}}function ps(l){let e=me.LookingGlass+"",t;return{c(){t=ne(e)},l(n){t=se(n,e)},m(n,i){T(n,t,i)},p:G,d(n){n&&m(t)}}}function gs(l){let e,t,n;return{c(){e=De("svg"),t=De("path"),n=De("path"),this.h()},l(i){e=Se(i,"svg",{slot:!0,xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,stroke:!0,fill:!0,"stroke-linecap":!0,"stroke-linejoin":!0});var s=x(e);t=Se(s,"path",{stroke:!0,d:!0,fill:!0}),x(t).forEach(m),n=Se(s,"path",{d:!0}),x(n).forEach(m),s.forEach(m),this.h()},h(){g(t,"stroke","none"),g(t,"d","M0 0h24v24H0z"),g(t,"fill","none"),g(n,"d","M5 12l5 5l10 -10"),g(e,"slot","icon"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"width","14"),g(e,"height","14"),g(e,"viewBox","0 0 24 24"),g(e,"stroke-width","2"),g(e,"stroke","currentColor"),g(e,"fill","none"),g(e,"stroke-linecap","round"),g(e,"stroke-linejoin","round"),ae(e,"hidden",!l[36])},m(i,s){T(i,e,s),I(e,t),I(e,n)},p(i,s){s[1]&32&&ae(e,"hidden",!i[36])},d(i){i&&m(e)}}}function ms(l){let e=me.DensityMap+"",t;return{c(){t=ne(e)},l(n){t=se(n,e)},m(n,i){T(n,t,i)},p:G,d(n){n&&m(t)}}}function _s(l){let e,t,n;return{c(){e=De("svg"),t=De("path"),n=De("path"),this.h()},l(i){e=Se(i,"svg",{slot:!0,xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,stroke:!0,fill:!0,"stroke-linecap":!0,"stroke-linejoin":!0});var s=x(e);t=Se(s,"path",{stroke:!0,d:!0,fill:!0}),x(t).forEach(m),n=Se(s,"path",{d:!0}),x(n).forEach(m),s.forEach(m),this.h()},h(){g(t,"stroke","none"),g(t,"d","M0 0h24v24H0z"),g(t,"fill","none"),g(n,"d","M5 12l5 5l10 -10"),g(e,"slot","icon"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"width","16"),g(e,"height","16"),g(e,"viewBox","0 0 24 24"),g(e,"stroke-width","2"),g(e,"stroke","currentColor"),g(e,"fill","none"),g(e,"stroke-linecap","round"),g(e,"stroke-linejoin","round"),ae(e,"hidden",!l[36])},m(i,s){T(i,e,s),I(e,t),I(e,n)},p(i,s){s[1]&32&&ae(e,"hidden",!i[36])},d(i){i&&m(e)}}}function bs(l){let e=me.ValenceMap+"",t;return{c(){t=ne(e)},l(n){t=se(n,e)},m(n,i){T(n,t,i)},p:G,d(n){n&&m(t)}}}function vs(l){let e,t,n;return{c(){e=De("svg"),t=De("path"),n=De("path"),this.h()},l(i){e=Se(i,"svg",{slot:!0,xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,stroke:!0,fill:!0,"stroke-linecap":!0,"stroke-linejoin":!0});var s=x(e);t=Se(s,"path",{stroke:!0,d:!0,fill:!0}),x(t).forEach(m),n=Se(s,"path",{d:!0}),x(n).forEach(m),s.forEach(m),this.h()},h(){g(t,"stroke","none"),g(t,"d","M0 0h24v24H0z"),g(t,"fill","none"),g(n,"d","M5 12l5 5l10 -10"),g(e,"slot","icon"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"width","16"),g(e,"height","16"),g(e,"viewBox","0 0 24 24"),g(e,"stroke-width","2"),g(e,"stroke","currentColor"),g(e,"fill","none"),g(e,"stroke-linecap","round"),g(e,"stroke-linejoin","round"),ae(e,"hidden",!l[36])},m(i,s){T(i,e,s),I(e,t),I(e,n)},p(i,s){s[1]&32&&ae(e,"hidden",!i[36])},d(i){i&&m(e)}}}function ks(l){let e,t,n,i,s,a;return e=new Le({props:{isActive:l[1]===me.LookingGlass,$$slots:{icon:[gs,({isActive:o})=>({36:o}),({isActive:o})=>[0,o?32:0]],default:[ps]},$$scope:{ctx:l}}}),e.$on("click",l[19]),n=new Le({props:{isActive:l[1]===me.DensityMap,$$slots:{icon:[_s,({isActive:o})=>({36:o}),({isActive:o})=>[0,o?32:0]],default:[ms]},$$scope:{ctx:l}}}),n.$on("click",l[20]),s=new Le({props:{isActive:l[1]===me.ValenceMap,$$slots:{icon:[vs,({isActive:o})=>({36:o}),({isActive:o})=>[0,o?32:0]],default:[bs]},$$scope:{ctx:l}}}),s.$on("click",l[21]),{c(){be(e.$$.fragment),t=K(),be(n.$$.fragment),i=K(),be(s.$$.fragment)},l(o){ve(e.$$.fragment,o),t=J(o),ve(n.$$.fragment,o),i=J(o),ve(s.$$.fragment,o)},m(o,r){ke(e,o,r),T(o,t,r),ke(n,o,r),T(o,i,r),ke(s,o,r),a=!0},p(o,r){const c={};r[0]&2&&(c.isActive=o[1]===me.LookingGlass),r[1]&96&&(c.$$scope={dirty:r,ctx:o}),e.$set(c);const u={};r[0]&2&&(u.isActive=o[1]===me.DensityMap),r[1]&96&&(u.$$scope={dirty:r,ctx:o}),n.$set(u);const p={};r[0]&2&&(p.isActive=o[1]===me.ValenceMap),r[1]&96&&(p.$$scope={dirty:r,ctx:o}),s.$set(p)},i(o){a||(V(e.$$.fragment,o),V(n.$$.fragment,o),V(s.$$.fragment,o),a=!0)},o(o){H(e.$$.fragment,o),H(n.$$.fragment,o),H(s.$$.fragment,o),a=!1},d(o){we(e,o),o&&m(t),we(n,o),o&&m(i),we(s,o)}}}function ws(l){let e,t,n,i,s;return{c(){e=$("div"),t=$("button"),n=ne("Load Survey Data"),this.h()},l(a){e=B(a,"DIV",{class:!0});var o=x(e);t=B(o,"BUTTON",{class:!0});var r=x(t);n=se(r,"Load Survey Data"),r.forEach(m),o.forEach(m),this.h()},h(){g(t,"class","py-1 px-2 bg-neutral-600 hover:bg-neutral-700 border border-neutral-900 shadow text-neutral-100 text-xs"),g(e,"class","row-start-2 row-end-4 flex items-center justify-center bg-neutral-800")},m(a,o){T(a,e,o),I(e,t),I(t,n),i||(s=Ie(t,"click",l[7]),i=!0)},p:G,i:G,o:G,d(a){a&&m(e),i=!1,s()}}}function Cs(l){let e=l[6],t,n,i=Wt(l);return{c(){i.c(),t=$e()},l(s){i.l(s),t=$e()},m(s,a){i.m(s,a),T(s,t,a),n=!0},p(s,a){a[0]&64&&_e(e,e=s[6])?(Ve(),H(i,1,1,G),Ne(),i=Wt(s),i.c(),V(i,1),i.m(t.parentNode,t)):i.p(s,a)},i(s){n||(V(i),n=!0)},o(s){H(i),n=!1},d(s){s&&m(t),i.d(s)}}}function Wt(l){let e,t,n={defaultPanelProps:l[6]};return e=new Dn({props:n}),l[23](e),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){ke(e,i,s),t=!0},p(i,s){const a={};s[0]&64&&(a.defaultPanelProps=i[6]),e.$set(a)},i(i){t||(V(e.$$.fragment,i),t=!0)},o(i){H(e.$$.fragment,i),t=!1},d(i){l[23](null),we(e,i)}}}function ys(l){let e,t,n,i,s,a,o,r,c,u,p,_,C,F,M,j,Q;n=new ht({props:{title:"Project",$$slots:{default:[cs]},$$scope:{ctx:l}}});let U=l[3]&&Ht(l);const oe=[Cs,ws],Y=[];function fe(v,P){return v[3]&&v[6]?0:1}return p=fe(l),_=Y[p]=oe[p](l),{c(){e=$("section"),t=$("header"),be(n.$$.fragment),i=K(),U&&U.c(),s=K(),a=$("span"),o=K(),r=$("h1"),c=ne("InteroMap"),u=K(),_.c(),C=K(),F=$("input"),this.h()},l(v){e=B(v,"SECTION",{class:!0});var P=x(e);t=B(P,"HEADER",{class:!0});var f=x(t);ve(n.$$.fragment,f),i=J(f),U&&U.l(f),s=J(f),a=B(f,"SPAN",{class:!0}),x(a).forEach(m),o=J(f),r=B(f,"H1",{class:!0,style:!0});var h=x(r);c=se(h,"InteroMap"),h.forEach(m),f.forEach(m),u=J(P),_.l(P),P.forEach(m),C=J(v),F=B(v,"INPUT",{type:!0,class:!0,accept:!0}),this.h()},h(){g(a,"class","flex-grow"),g(r,"class","flex items-center h-full px-2 bg-gradient-to-t from-orange-600 to-orange-500 text-neutral-100 font-bold text-xs lowercase tracking-wider"),ft(r,"font-variant","small-caps"),g(t,"class","emboss z-20 flex items-center bg-neutral-600 border-b border-neutral-800"),g(e,"class","app-layout w-screen h-screen svelte-14urve1"),g(F,"type","file"),g(F,"class","hidden"),g(F,"accept",".csv")},m(v,P){T(v,e,P),I(e,t),ke(n,t,null),I(t,i),U&&U.m(t,null),I(t,s),I(t,a),I(t,o),I(t,r),I(r,c),I(e,u),Y[p].m(e,null),T(v,C,P),T(v,F,P),l[24](F),M=!0,j||(Q=Ie(F,"change",l[10]),j=!0)},p(v,P){const f={};P[0]&8|P[1]&64&&(f.$$scope={dirty:P,ctx:v}),n.$set(f),v[3]?U?(U.p(v,P),P[0]&8&&V(U,1)):(U=Ht(v),U.c(),V(U,1),U.m(t,s)):U&&(Ve(),H(U,1,1,()=>{U=null}),Ne());let h=p;p=fe(v),p===h?Y[p].p(v,P):(Ve(),H(Y[h],1,1,()=>{Y[h]=null}),Ne(),_=Y[p],_?_.p(v,P):(_=Y[p]=oe[p](v),_.c()),V(_,1),_.m(e,null))},i(v){M||(V(n.$$.fragment,v),V(U),V(_),M=!0)},o(v){H(n.$$.fragment,v),H(U),H(_),M=!1},d(v){v&&m(e),we(n),U&&U.d(),Y[p].d(),v&&m(C),v&&m(F),l[24](null),j=!1,Q()}}}function Es(l){const e=[];for(let t of l)if("interoMapPoints"in t)try{const n=Ps(t.interoMapPoints);Object.keys(n).every(s=>["FemaleFront","FemaleBack","MaleFront","MaleBack"].includes(s))&&e.push(n)}catch{console.error("Could not parse row:",t)}return e}function Ps(l){return JSON.parse(l)}function Ds(l){const e=[],t={MaleFront:[],MaleBack:[],FemaleFront:[],FemaleBack:[]};for(let n=0,i=l.length;n<i;++n){const s=l[n],a=Object.keys(s);e.push({id:n+1,surveyData:s});for(let o of a){const r=s[o];r&&r.length>0&&t[o].push(r)}}return[e,t]}function Ss(l,e,t){let n,i=!1,s,a,o,r,c=me.LookingGlass,u=[],p={MaleFront:[],MaleBack:[],FemaleFront:[],FemaleBack:[]};function _(){n.click()}function C(){t(3,i=!1),t(14,u=[]),p={MaleFront:[],MaleBack:[],FemaleFront:[],FemaleBack:[]}}function F(){t(6,o=void 0),r.$destroy()}function M(){lt.selectedParticipantIdx.set(0),Ze.mapColors.FemaleFront.set("#0000FF"),Ze.mapColors.FemaleBack.set("#0000FF"),Ze.mapColors.MaleFront.set("#0000FF"),Ze.mapColors.MaleBack.set("#0000FF")}function j(){C(),F(),M()}function Q(D){r.setView(D),s.close()}function U(){n.files&&n.files.length>0&&(r&&j(),oe(n.files[0]))}function oe(D){yt.parse(D,{worker:!0,header:!0,complete:Y})}function Y(D){const k=Es(D.data);t(14,[u,p]=Ds(k),u);const E=f(c);t(6,o=E),t(3,i=!0)}function fe(){const D={tabs:[]};let k;for(k in p)D.tabs.push({title:k,component:qn,props:{workspace:r,persona:k,participantsDrawings:p[k]},isDisabled:!0});return D.caption="Looking Glass",D}function v(){const D={tabs:[]};let k=!0,E;for(E in p)D.tabs.push({title:E,component:es,props:{persona:E,participantsStrokes:p[E],totalParticipants:u.length},isActive:k}),k=!1;return D.caption="Density Map",D}function P(){const D={tabs:[]};let k=!0,E;for(E in p)D.tabs.push({title:E,component:is,props:{persona:E,participantsStrokes:p[E],totalParticipants:u.length},isActive:k}),k=!1;return D.caption="Valence Map",D}function f(D){switch(D){case me.LookingGlass:return fe();case me.DensityMap:return v();case me.ValenceMap:return P();default:return fe()}}function h(D){t(1,c=D),a.close()}function d(){const D=r.getActiveComponent();if(D){const k=D.getImage(),E=document.createElement("a");E.href=k.data,E.target="_blank",E.download=`InteroMap_${k.name}.png`,E.click()}}function w(){const k=[["Participant Number","Stroke Valence","Stroke Intensity","Brush Size (pixels)"]];for(let z of u)for(let ie in z.surveyData)for(let ee of z.surveyData[ie])k.push([z.id,ee.valence,ee.intensity,ee.brushSize]);const E=yt.unparse(k);return"data:text/csv;base64,"+btoa(E)}function y(){const D=w(),k=document.createElement("a");k.href=D,k.target="_blank",k.download="InteroMap-Data.csv",k.click()}const A=()=>Q("single"),L=()=>Q("dual"),Z=()=>Q("grid");function W(D){ye[D?"unshift":"push"](()=>{s=D,t(4,s)})}const b=()=>h(me.LookingGlass),N=()=>h(me.DensityMap),R=()=>h(me.ValenceMap);function he(D){ye[D?"unshift":"push"](()=>{a=D,t(5,a)})}function X(D){ye[D?"unshift":"push"](()=>{r=D,t(0,r)})}function S(D){ye[D?"unshift":"push"](()=>{n=D,t(2,n)})}return l.$$.update=()=>{if(l.$$.dirty[0]&16387&&r&&u.length>0&&c===me.LookingGlass){const D=lt.selectedParticipantIdx.subscribe(k=>{const E=Object.keys(u[k].surveyData);r.enableTabs(E)});r.$on("destroy",D)}l.$$.dirty[0]&2&&c&&t(6,o=f(c))},[r,c,n,i,s,a,o,_,j,Q,U,h,d,y,u,A,L,Z,W,b,N,R,he,X,S]}class xs extends Ee{constructor(e){super(),Pe(this,e,Ss,ys,_e,{},null,[-1,-1])}}export{xs as default};
